(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(4923)}])},4923:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return br}});var n=r(47568),a=r(828),i=r(34051),s=r.n(i),o=r(85893),c=r(41330),l=r(35005),u=r(67294);function d(){return(0,o.jsxs)("div",{style:{color:"white",lineHeight:"160%"},className:"px-3",children:[(0,o.jsxs)("div",{className:"mb-5",children:[(0,o.jsx)("h3",{className:"mb-3",children:"What is the Geo Web?"}),(0,o.jsx)("p",{children:"The Geo Web is a fair and productive property rights system for anchoring digital media to physical locations. It creates a shared augmented reality layer of the metaverse."})]}),(0,o.jsxs)("div",{className:"mb-5",children:[(0,o.jsx)("h3",{className:"mb-3",children:"The Geo Web uses partial common ownership to administer its land market and fund public goods:"}),(0,o.jsxs)("ol",{children:[(0,o.jsx)("li",{className:"py-1",children:"Geo Web land parcels are NFTs that correspond to physical world locations."}),(0,o.jsx)("li",{className:"py-1",children:"All land parcels have a publicly triggerable `For Sale Price` set by the current licensor."}),(0,o.jsx)("li",{className:"py-1",children:"The current licensor must pay an annual `Network Fee` equal to 10% of their current `For Sale Price` to maintain their rights."}),(0,o.jsx)("li",{className:"py-1",children:"`Network Fees` are used to fund public goods (not a centralized corporation). You have a say in how these funds are used!"})]})]}),(0,o.jsxs)("div",{className:"mb-5",children:[(0,o.jsx)("h3",{className:"mb-3",children:"The Geo Web is a geospatial successor to the World Wide Web."}),(0,o.jsx)("p",{children:"Landholders can anchor NFTs, AR/VR, images, video, audio, data, and more within the geospatial bounds of their parcel as part of an open ecosystem (think of parcels like three-dimensional websites). Users naturally discover content anchored to Geo Web parcels with Spatial Browsers that navigate with geolocation instead of URLs."})]})]})}var p=function(e){var t=e.connectWallet,r=e.status;return(0,o.jsxs)("div",{style:{background:"url(bg.jpg) no-repeat center",backgroundSize:"cover",paddingBottom:"24px",position:"absolute",left:"0",top:"0",padding:"16px"},children:[(0,o.jsxs)("div",{style:{paddingTop:"128px",gap:"24px"},className:"d-flex flex-column flex-md-row justify-content-between align-items-center px-2",children:[(0,o.jsx)(d,{}),(0,o.jsxs)("div",{className:"px-3 mb-5 d-flex align-items-center flex-column",children:[(0,o.jsx)(c.Z,{className:"mb-2",src:"/arMedia.gif",alt:"arMedia"}),(0,o.jsx)("span",{style:{fontSize:"12px",color:"white"},children:"Browsing an AR Media Gallery on the Geo Web"})]})]}),(0,o.jsxs)("div",{className:"d-flex flex-column align-items-center",children:[(0,o.jsxs)(l.Z,{variant:"primary",className:"text-light fw-bold border-dark mx-auto fit-content",style:{padding:"16px 18px"},disabled:"connecting"===r,onClick:t,children:[(0,o.jsx)(c.Z,{src:"vector.png",width:"40",style:{marginRight:20}}),(0,o.jsx)("span",{children:"Get Started"})]}),(0,o.jsx)(c.Z,{src:"/claming.gif",className:"mt-5",style:{maxWidth:"80%"},alt:""}),(0,o.jsx)("span",{style:{fontSize:"12px",marginTop:"18px",color:"white"},children:"Claiming a land parcel in New York City on the Geo Web"})]})]})},m=r(14924),f=r(26042),h=r(69396),x=r(7297),g=r(31230),b=r(55850),v=r(31555),y=r(33403),j=r(19651),w=r.n(j);function k(e){var t=(0,u.useState)(null),r=t[0],n=t[1],a=(0,y.PE)((function(){var t=new(w())((0,h.Z)((0,f.Z)({},e),{marker:!1,accessToken:e.mapboxAccessToken}));return t.on("loading",e.onLoading),t.on("results",e.onResults),t.on("result",(function(t){var r;e.onResult(t);var a=t.result,i=a&&(a.center||"Point"===(null===(r=a.geometry)||void 0===r?void 0:r.type)&&a.geometry.coordinates);i&&e.marker?n((0,o.jsx)(y.Jx,(0,h.Z)((0,f.Z)({},e.marker),{longitude:i[0],latitude:i[1],color:"#2fc1c1"}))):n(null)})),t.on("error",e.onError),t}),{position:e.position});return a._map&&(a.getProximity()!==e.proximity&&void 0!==e.proximity&&a.setProximity(e.proximity),a.getRenderFunction()!==e.render&&void 0!==e.render&&a.setRenderFunction(e.render),a.getLanguage()!==e.language&&void 0!==e.language&&a.setLanguage(e.language),a.getZoom()!==e.zoom&&void 0!==e.zoom&&a.setZoom(e.zoom),a.getFlyTo()!==e.flyTo&&void 0!==e.flyTo&&a.setFlyTo(e.flyTo),a.getPlaceholder()!==e.placeholder&&void 0!==e.placeholder&&a.setPlaceholder(e.placeholder),a.getCountries()!==e.countries&&void 0!==e.countries&&a.setCountries(e.countries),a.getTypes()!==e.types&&void 0!==e.types&&a.setTypes(e.types),a.getMinLength()!==e.minLength&&void 0!==e.minLength&&a.setMinLength(e.minLength),a.getLimit()!==e.limit&&void 0!==e.limit&&a.setLimit(e.limit),a.getFilter()!==e.filter&&void 0!==e.filter&&a.setFilter(e.filter),a.getOrigin()!==e.origin&&void 0!==e.origin&&a.setOrigin(e.origin)),r}var S=function(){};k.defaultProps={marker:!0,onLoading:S,onResults:S,onResult:S,onError:S};var Z=k,C=r(67525),N=r(99301),P=r(61744),I=r(2593),E=r(21608),T=r(59953),F=r(13550),L=r.n(F),A=r(73928),R=r(43489);var D=function(e){var t=e.content,r=e.target,n=(0,u.useState)(!1),a=n[0],i=n[1],s=function(){return i(!0)},c=function(){return i(!1)};return(0,o.jsx)(A.Z,{trigger:["hover","focus"],show:a,placement:"right-end",overlay:(0,o.jsx)(R.Z,{onMouseEnter:s,onMouseLeave:c,children:t}),children:(0,o.jsx)("span",{onMouseEnter:s,onMouseLeave:c,children:r})})};function G(e,t){if(e.length<=t)return e;var r=t-"...".length,n=Math.ceil(r/2),a=Math.floor(r/2);return e.substr(0,n)+"..."+e.substr(e.length-a)}function W(e,t){if(e.includes(".")){var r=e.split(".");return r[0]+"."+r[1].slice(0,t)}return e}var M=r(6212),B=function(e){return P.dF(e)},_=function(){var e=(0,n.Z)(s().mark((function e(t,r){var n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getBalance(r);case 2:return n=e.sent,a=B(n),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),O=r(66477),U=function(e){var t=e.accountTokenSnapshot,r=e.format,n=void 0===r?function(e){return e}:r,a=(0,u.useState)(""),i=a[0],s=a[1];return(0,u.useEffect)((function(){var e=I.O$.from(t?t.balanceUntilUpdatedAt:"0"),r=I.O$.from(t?t.totalNetFlowRate:"0"),a=I.O$.from(t?t.updatedAtTimestamp:"0").mul(1e3),i=!1,o=0,c=function(t){if(t-o>100){if(i)return;var l=I.O$.from((new Date).getTime());s(n(e.add(l.sub(a).mul(r).div(1e3)).toString())),o=t}window.requestAnimationFrame(c)};return window.requestAnimationFrame(c),function(){i=!0}}),[t,n]),(0,o.jsx)("span",{children:i})},Y=r(36968),z=r(27389),q=function(e){var t=e.options,r=(0,a.Z)((0,z.Wx)(),1)[0],n=(0,u.useCallback)((function(){navigator.clipboard.writeText(t.address)}),[t.address]),i=(0,u.useCallback)((function(){"connected"===r.status&&r.connected.provider.state.provider.request({method:"wallet_watchAsset",params:{type:"ERC20",options:t}})}),[]);return(0,o.jsxs)("div",{className:"bg-gray rounded d-flex align-items-center",children:[(0,o.jsx)(A.Z,{trigger:"click",placement:"top",delay:{show:250,hide:4e3},overlay:(0,o.jsx)(R.Z,{children:"Copied"}),children:(0,o.jsxs)(l.Z,{onClick:n,className:"d-flex bg-transparent border-0 align-items-center",children:[(0,o.jsx)(c.Z,{style:{width:"16px"},src:"/eth.png",alt:"eth"}),(0,o.jsx)("span",{className:"text-black ".concat("small"===t.size?"px-1 small":"px-2"),children:G(t.address,16)}),(0,o.jsx)(c.Z,{style:{width:"16px"},src:"/copy.svg",alt:"copy"})]})}),(0,o.jsx)(l.Z,{className:"bg-transparent border-0 ".concat("small"===t.size?"px-1":"px-2"),onClick:i,children:(0,o.jsx)(c.Z,{style:{width:"16px"},src:"/MetaMask.png",alt:"metamask"})})]})};var H=function(e){var t=e.account,r=e.provider,i=e.show,c=e.handleClose,d=e.paymentToken,p=(0,a.Z)(u.useState(),2),m=p[0],f=p[1],h=(0,a.Z)(u.useState(!1),2),x=h[0],g=h[1],b=O.hm.useAccountTokenSnapshotsQuery({chainId:T.er,filter:{account:t,token:d.address}}),v=b.isLoading,y=b.data;u.useEffect((function(){var e=!0;return(0,n.Z)(s().mark((function n(){var a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r||!t){n.next=11;break}return n.prev=1,n.next=4,_(r,t);case 4:a=n.sent,e&&f(a),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),console.error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))(),function(){e=!1}}),[r,t]);var j=function(){var e=(0,n.Z)(s().mark((function e(n){var a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.upgrade({amount:P.fi(n).toString()}).exec(r.getSigner());case 2:return a=e.sent,g(!0),e.prev=4,e.next=7,a.wait();case 7:return e.next=9,_(r,t);case 9:i=e.sent,f(i),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.error(e.t0);case 16:g(!1);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),w=u.useMemo((function(){return{address:d.address,symbol:"ETHx",decimals:18,image:""}}),[d.address]);return(0,o.jsxs)(M.Z,{show:i,onHide:c,centered:!0,contentClassName:"bg-dark",className:"wrap-modal",children:[(0,o.jsxs)(M.Z.Header,{className:"bg-dark border-0",children:[(0,o.jsx)(M.Z.Title,{className:"text-primary",children:"Wrap ETH for Streaming"}),(0,o.jsx)(l.Z,{type:"button",className:"btn-close btn-close-white","data-dismiss":"modal","aria-label":"Close",onClick:c})]}),(0,o.jsxs)(M.Z.Body,{className:"bg-dark text-light position-relative",children:[(0,o.jsx)("p",{children:"Current Balances"}),(0,o.jsxs)("div",{style:{padding:"0 16px"},children:[(0,o.jsxs)("p",{children:["ETH: ",null!==m&&void 0!==m?m:"---"]}),(0,o.jsxs)("p",{className:"mb-0 me-3",children:["ETHx:"," ",v||null==y?(0,o.jsx)(Y.Z,{animation:"border",role:"status"}):(0,o.jsx)(U,{format:function(e){return P.bM(e)},accountTokenSnapshot:y.items[0]})]}),(0,o.jsx)("div",{className:"position-absolute",style:{bottom:"16px",right:"16px"},children:(0,o.jsx)(q,{options:w})})]})]}),(0,o.jsx)(M.Z.Footer,{className:"bg-dark text-light",style:{position:"relative"},children:(0,o.jsxs)("form",{id:"wrapForm",className:"form-inline",noValidate:!0,onSubmit:function(e){e.preventDefault();var t=Number(e.target[0].value);t<=Number(m)&&!Number.isNaN(t)&&t>0&&(console.log("amount is valid",t),(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t.toString());case 2:document.getElementById("wrapForm").reset();case 4:case"end":return e.stop()}}),e)})))())},children:[(0,o.jsx)("label",{className:"visually-hidden",htmlFor:"amount",children:"Amount"}),(0,o.jsx)("input",{required:!0,autoFocus:!0,type:"text",className:"form-control mb-2 me-sm-6 text-white",style:{backgroundColor:"#111320",border:"none",position:"absolute",left:"16px",width:"auto"},id:"amount",placeholder:"0.00"}),(0,o.jsx)(l.Z,{type:"submit",className:"btn btn-primary mb-2",style:{width:"128px"},disabled:x,children:x?"Wrapping...":"Wrap to ".concat(T.RU)})]})})]})},$=r(51438),V=r(88029),Q=r(91224),X=r(59111),K=function(){function e(t,r,n){(0,$.Z)(this,e),this.ceramic=t,this._schemaStreamId=null!==r&&void 0!==r?r:void 0,this._shouldPin=!0,this._controller=n}var t=e.prototype;return t.setExistingStreamId=function(e){var t=this;return(0,n.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=3;break}return t.stream=null,r.abrupt("return");case 3:return r.next=5,X.E.load(t.ceramic,e);case 5:t.stream=r.sent;case 6:case"end":return r.stop()}}),r)})))()},t.getStreamId=function(){return this.stream?this.stream.id:null},t.getStreamContent=function(){return this.stream?this.stream.content:null},t.getCommitId=function(){return this.stream?this.stream.commitId:null},t.createOrUpdateStream=function(e,t,r){var a=this;return(0,n.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!a.stream){n.next=5;break}return n.next=3,a.updateStream(e);case 3:n.next=14;break;case 5:return n.next=7,X.E.create(a.ceramic,null,{schema:a._schemaStreamId,controllers:[null!==t&&void 0!==t?t:a._controller],family:"geoweb",deterministic:null===r||void 0===r||r},{anchor:!1,publish:!1});case 7:return a.stream=n.sent,n.next=10,a.updateStream(e);case 10:if(!a._shouldPin){n.next=13;break}return n.next=13,a.ceramic.pin.add(a.stream.id);case 13:return n.abrupt("return",a.stream.id.toString());case 14:case"end":return n.stop()}}),n)})))()},t.updateStream=function(e,t){var r=this;return(0,n.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.stream){n.next=3;break}return console.error("Stream does not exist"),n.abrupt("return");case 3:if(!Array.isArray(e)){n.next=8;break}return n.next=6,r.stream.update(e,t);case 6:n.next=10;break;case 8:return n.next=10,r.stream.update((0,f.Z)({},r.stream.content,e),t);case 10:case"end":return n.stop()}}),n)})))()},e}(),J=function(e){(0,V.Z)(r,e);var t=(0,Q.Z)(r);function r(e){var n;return(0,$.Z)(this,r),(n=t.call(this,e.ceramic,e.model.getSchemaURL("BasicProfile"),e.controller)).assetContentManager=e,n}var a=r.prototype;return a.createOrUpdateStream=function(e){var t=this;return(0,n.Z)(s().mark((function r(){var n;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.assetContentManager.set("basicProfile",e);case 2:if(n=r.sent,t.stream){r.next=7;break}return r.next=6,t.assetContentManager.getRecord("basicProfile");case 6:t.stream=r.sent;case 7:return r.abrupt("return",n);case 8:case"end":return r.stop()}}),r)})))()},a.updateStream=function(e){var t=this;return(0,n.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.createOrUpdateStream(e);case 2:case"end":return r.stop()}}),r)})))()},r}(K);var ee=r(67118),te=r(4702),re=r(78385),ne=function(){function e(t,r,n,a){(0,$.Z)(this,e),this.ceramic=t,this.model=r,this.controller=n,this.assetId=a}var t=e.prototype;return t.set=function(e,t){var r=this;return(0,n.Z)(s().mark((function n(){var a,i,o,c;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.getIndex();case 2:if(a=n.sent,i=r.model.getDefinitionID(e)){n.next=6;break}throw new Error("Could not find definitionID");case 6:if(!a.content[i]){n.next=15;break}return n.next=9,X.E.load(r.ceramic,a.content[i]);case 9:return o=n.sent,n.next=12,o.update(t);case 12:return n.abrupt("return",o.id.toString());case 15:return n.next=17,X.E.create(r.ceramic,t,{controllers:[r.controller],family:"geoweb"});case 17:return c=n.sent,n.next=20,a.update((0,h.Z)((0,f.Z)({},a.content),(0,m.Z)({},i,"ceramic://".concat(c.id.toString()))));case 20:return n.abrupt("return",c.id.toString());case 21:case"end":return n.stop()}}),n)})))()},t.getRecordID=function(e){var t=this;return(0,n.Z)(s().mark((function r(){var n,a;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getIndex();case 2:if(n=r.sent,a=t.model.getDefinitionID(e)){r.next=6;break}throw new Error("Could not find definitionID");case 6:return r.abrupt("return",n.content[a]);case 7:case"end":return r.stop()}}),r)})))()},t.getRecord=function(e){var t=this;return(0,n.Z)(s().mark((function r(){var n;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getRecordID(e);case 2:return n=r.sent,r.next=5,X.E.load(t.ceramic,n);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),r)})))()},t.getIndex=function(){var e=this;return(0,n.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.E.deterministic(e.ceramic,{controllers:[e.controller],schema:"k3y52l7qbv1fryjn62sggjh1lpn11c56qfofzmty190d62hwk1cal1c7qc5he54ow",family:"geoweb",tags:[e.assetId.toString()]});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},e}(),ae=r(48533);var ie=function(e){return(0,o.jsxs)(ae.Z,{variant:"danger",dismissible:!0,onClick:e.onClick,children:[(0,o.jsx)(ae.Z.Heading,{style:{fontSize:"1em"},children:"Transaction Failed"}),(0,o.jsx)("p",{style:{fontSize:"0.8em"},children:"Something went wrong: ".concat(e.message?e.message.replace(/([^.])$/,"$1."):"unknown reason.")})]})},se=r(21046),oe=function(){var e=(0,n.Z)(s().mark((function e(t,r){var n,a,i,o,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,a=!1,i=void 0,e.prev=1,o=t[Symbol.iterator]();case 3:if(n=(c=o.next()).done){e.next=12;break}return l=c.value,e.next=7,r(l);case 7:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:n=!0,e.next=3;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),a=!0,i=e.t0;case 18:e.prev=18,e.prev=19,n||null==o.return||o.return();case 21:if(e.prev=21,!a){e.next=24;break}throw i;case 24:return e.finish(21);case 25:return e.finish(18);case 26:return e.abrupt("return",!0);case 27:case"end":return e.stop()}}),e,null,[[1,14,18,26],[19,,21,25]])})));return function(t,r){return e.apply(this,arguments)}}();function ce(e){var t=e.isDisabled,r=e.performAction,i=e.buttonText,c=e.paymentToken,d=e.account,p=e.spender,m=e.provider,f=e.requiredPayment,h=e.sfFramework,x=e.requiredFlowPermissions,g=e.requiredFlowAmount,b=e.flowOperator,v=e.setErrorMessage,y=e.setIsActing,j=e.setDidFail,w=(0,a.Z)(u.useState([]),2),k=w[0],S=w[1],Z=(0,a.Z)(u.useState(i),2),C=Z[0],N=Z[1],P=(0,a.Z)(u.useState(0),2),E=P[0],F=P[1],L=(0,a.Z)(u.useState(0),2),A=L[0],R=L[1],D=f&&g&&x&&p&&b,G=(0,o.jsx)(Y.Z,{as:"span",size:"sm",animation:"border",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Sending Transaction..."})}),W=u.useCallback((0,n.Z)(s().mark((function e(){var t,r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}return e.abrupt("return",!0);case 2:return t=m.getSigner(),e.prev=3,r=c.approve({amount:se.Bz.toString(),receiver:p}),e.next=7,r.exec(t);case 7:return n=e.sent,e.next=10,n.wait();case 10:e.next=19;break;case 12:return e.prev=12,e.t0=e.catch(3),console.error(e.t0),v(e.t0.reason?e.t0.reason.replace("execution reverted: ",""):e.t0.message),y(!1),j(!0),e.abrupt("return",!1);case 19:return e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,null,[[3,12]])}))),[p]),M=u.useCallback((0,n.Z)(s().mark((function e(){var t,r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b){e.next=2;break}return e.abrupt("return",!0);case 2:return t=m.getSigner(),e.prev=3,r=h.cfaV1.authorizeFlowOperatorWithFullControl({superToken:c.address,flowOperator:b}),e.next=7,r.exec(t);case 7:return n=e.sent,e.next=10,n.wait();case 10:e.next=19;break;case 12:return e.prev=12,e.t0=e.catch(3),console.error(e.t0),v(e.t0.reason?e.t0.reason.replace("execution reverted: ",""):e.t0.message),y(!1),j(!0),e.abrupt("return",!1);case 19:return e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,null,[[3,12]])}))),[b]);u.useEffect((function(){var e=function(){var e=(0,n.Z)(s().mark((function e(){var t,r,n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],r=i,D){e.next=6;break}return S(t),N(r),e.abrupt("return");case 6:return e.next=8,c.allowance({owner:d,spender:p,providerOrSigner:m});case 8:return n=e.sent,f&&I.O$.from(n).lt(f)&&(t.push(W),r="Allow ".concat(T.RU," Transfer")),e.next=12,h.cfaV1.getFlowOperatorData({superToken:c.address,flowOperator:b,sender:d,providerOrSigner:m});case 12:a=e.sent,g&&x&&(I.O$.from(a.flowRateAllowance).lt(g)||Number(a.permissions)<x)&&(t.push(M),r=t.length>1?"Allow ".concat(T.RU," Transfer + Stream"):"Allow ".concat(T.RU," Stream")),S(t),N(r);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[c,d,p,b,m,f,E]);var B=u.useCallback((0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(k.length>0)){e.next=9;break}return R(k.length),F(0),N(i),t=0,e.next=7,oe(k,function(){var e=(0,n.Z)(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:return n=e.sent,F(++t),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:e.next=14;break;case 9:return R(1),F(0),e.next=13,r();case 13:R(0);case 14:case"end":return e.stop()}}),e)}))),[k,E,i]);return(0,o.jsx)(l.Z,{variant:"primary",className:"w-100",onClick:function(){return B()},disabled:t||A>E||!D,children:A>E?(0,o.jsxs)(o.Fragment,{children:[G," ","".concat(E,"/").concat(A)]}):C})}function le(e){var t=function(e){y(function(e){return function(t){return(0,f.Z)({},t,e)}}(e))},r=e.account,i=e.licenseOwner,d=e.provider,p=e.perSecondFeeNumerator,m=e.perSecondFeeDenominator,x=e.loading,g=e.performAction,b=e.actionData,y=e.setActionData,j=e.basicProfileStreamManager,w=e.interactionState,k=e.setInteractionState,S=e.licenseAddress,Z=e.ceramic,F=e.setSelectedParcelId,A=e.paymentToken,R=e.summaryView,G=e.requiredBid,M=e.requiredPayment,_=e.spender,O=e.hasOutstandingBid,U=void 0!==O&&O,Y=e.setIsPortfolioToUpdate,z=b.parcelName,q=b.parcelWebContentURI,$=b.displayNewForSalePrice,V=b.displayCurrentForSalePrice,Q=b.didFail,X=b.isActing,K=b.errorMessage,ae=(0,a.Z)(u.useState(!1),2),se=ae[0],oe=ae[1],le=(0,o.jsx)(c.Z,{style:{width:"1.1rem",marginLeft:"4px"},src:"info.svg"}),ue=null!=$&&$.length>0&&(isNaN(Number($))||P.fi($).lt(null!==G&&void 0!==G?G:I.O$.from(0))),de=p.toNumber()*T.eG*100/m.toNumber(),pe=null!=$&&$.length>0&&!isNaN(Number($))?P.fi($).mul(de).div(100):null,me=!!z&&z.length>150,fe=!!q&&(0==/^(http|https|ipfs|ipns):\/\/[^ "]+$/.test(q)||q.length>150),he=pe;function xe(){return xe=(0,n.Z)(s().mark((function e(){var r,n,a,i,o,c,l,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({isActing:!0,didFail:!1}),e.prev=2,e.next=5,g();case 5:r=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),console.error(e.t0),t({isActing:!1,didFail:!0,errorMessage:e.t0.reason?e.t0.reason.replace("execution reverted: ",""):e.t0.message}),e.abrupt("return");case 13:if(n={},z&&(n.name=z),q&&(n.url=q),!r||j){e.next=28;break}return i=new ee.xW({chainId:"eip155:".concat(T.er),assetName:{namespace:"erc721",reference:S.toLowerCase()},tokenId:r.toString()}),o=new re.v({ceramic:Z,aliases:te.model}),l=new ne(Z,o,null!==(c=null===(a=Z.did)||void 0===a?void 0:a.capability.p.iss)&&void 0!==c?c:"",i),u=new J(l),e.next=25,u.createOrUpdateStream(n);case 25:F("0x".concat(new(L())(r.toString()).toString(16))),e.next=31;break;case 28:if(!j){e.next=31;break}return e.next=31,j.createOrUpdateStream(n);case 31:t({isActing:!1}),k(Wt.PARCEL_SELECTED),Y(!0);case 34:case"end":return e.stop()}}),e,null,[[2,8]])}))),xe.apply(this,arguments)}var ge=ue||!$,be=x;return u.useEffect((function(){null==$&&t({displayNewForSalePrice:V})}),[V,$,t]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(C.Z,{border:"secondary",className:"bg-dark mt-5",children:[(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsxs)(N.Z,{children:[(0,o.jsxs)(N.Z.Group,{children:[w==Wt.PARCEL_RECLAIMING&&r.toLowerCase()==(null===i||void 0===i?void 0:i.toLowerCase())?null:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(N.Z.Text,{className:"text-primary mb-1",children:"Parcel Name"}),(0,o.jsx)(N.Z.Control,{isInvalid:me,className:"bg-dark text-light mt-1",type:"text",placeholder:"Parcel Name","aria-label":"Parcel Name","aria-describedby":"parcel-name",defaultValue:z,disabled:X||be,onChange:function(e){return t({parcelName:e.target.value})}}),me?(0,o.jsx)(N.Z.Control.Feedback,{type:"invalid",children:"Parcel name cannot be longer than 150 characters"}):null,(0,o.jsx)("br",{}),(0,o.jsx)(N.Z.Text,{className:"text-primary mb-1",children:"Content Link (http://, https://, ipfs://, ipns://)"}),(0,o.jsx)(N.Z.Control,{isInvalid:fe,className:"bg-dark text-light mt-1",type:"text",placeholder:"URI (http://, https://, ipfs://, ipns://)","aria-label":"Web Content URI","aria-describedby":"web-content-uri",defaultValue:q,disabled:X||be,onChange:function(e){return t({parcelWebContentURI:e.target.value})}}),fe?(0,o.jsx)(N.Z.Control.Feedback,{type:"invalid",children:"Web content URI must be one of (http://,https://,ipfs://,ipns://) and less than 150 characters"}):null,(0,o.jsx)("br",{})]}),(0,o.jsxs)(N.Z.Text,{className:"text-primary mb-1",children:["For Sale Price (",T.RU,")",(0,o.jsx)(D,{content:(0,o.jsxs)("div",{style:{textAlign:"left"},children:["Be honest about your personal valuation!",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"You'll have 7 days to accept or reject any bid that meets this price. You must pay a penalty equal to 10% of the bidder's new For Sale Price if you wish to reject the bid."," ",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),(0,o.jsx)("a",{href:"https://docs.geoweb.network/concepts/partial-common-ownership",target:"_blank",rel:"noopener",children:"You can read more about Partial Common Ownership in our docs."})]}),target:le})]}),(0,o.jsx)(N.Z.Control,{required:!0,isInvalid:ue,className:U?"bg-dark text-info mt-1":"bg-dark text-light mt-1",type:"text",placeholder:"New For Sale Price (".concat(T.RU,")"),"aria-label":"For Sale Price","aria-describedby":"for-sale-price",defaultValue:V,disabled:X||be||U,onChange:function(e){return t({displayNewForSalePrice:e.target.value})}}),ue?(0,o.jsxs)(N.Z.Control.Feedback,{type:"invalid",children:["For Sale Price must be a number greater than"," ",G?W(P.dF(G),8):"0"]}):null,(0,o.jsx)("br",{}),(0,o.jsxs)(N.Z.Text,{className:"text-primary mb-1",children:[de,"% Network Fee (",T.RU,", Streamed)",(0,o.jsx)(D,{content:(0,o.jsxs)("div",{style:{textAlign:"left"},children:["Network fees are proportional to your For Sale Price. They discourage squatting & create a healthier market. They are used to fund public goods\u2014promoting positive-sum outcomes. You have a say in how they're spent!",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"You pay these fees by opening a per-second stream. Your total yearly payment will be slightly lower than the displayed value due to rounding."]}),target:le})]}),(0,o.jsx)(N.Z.Control,{className:"bg-dark text-info mt-1",type:"text",readOnly:!0,disabled:!0,value:"".concat(pe?W(B(pe),10):"0"," ").concat(T.RU,"/year"),"aria-label":"Network Fee","aria-describedby":"network-fee"})]}),(0,o.jsx)("br",{}),(0,o.jsx)("hr",{className:"action-form_divider"}),(0,o.jsx)("br",{}),R,(0,o.jsx)("br",{}),(0,o.jsx)(l.Z,{variant:"secondary",className:"w-100 mb-3",onClick:function(){return oe(!0)},children:"Wrap to ".concat(T.RU)}),(0,o.jsx)(ce,(0,h.Z)((0,f.Z)({},e),{isDisabled:X||be||ge,buttonText:"Confirm",requiredFlowAmount:he,requiredPayment:null!==M&&void 0!==M?M:null,performAction:function(){return xe.apply(this,arguments)},spender:null!==_&&void 0!==_?_:null,setErrorMessage:function(e){t({errorMessage:e})},setIsActing:function(e){t({isActing:e})},setDidFail:function(e){t({didFail:e})}}))]}),(0,o.jsx)("br",{}),Q&&!X?(0,o.jsx)(ie,{message:K,onClick:function(){return t({didFail:!1})}}):null]}),(0,o.jsx)(C.Z.Footer,{className:"border-top border-secondary",children:(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(v.Z,{sm:"1",children:(0,o.jsx)(c.Z,{src:"notice.svg"})}),(0,o.jsx)(v.Z,{className:"fst-italic",children:"Claims, transfers, changes to For Sale Prices, and network fee payments require confirmation in your Web3 wallet."})]})})]}),se&&(0,o.jsx)(H,{account:r,provider:d,show:se,handleClose:function(){return oe(!1)},paymentToken:A})]})}var ue,de,pe,me=r(67162),fe=r(10682),he=r(29815),xe=r(27484),ge=r.n(xe),be=r(75147),ve=r(77021),ye={1:4,4:1,5:1,69:1};function je(e,t,r){return e.mul(t).div(r)}function we(e){if(e<=0)return"0d 0h 0m 0s";var t=Math.floor(e/864e5),r=Math.floor(e%864e5/36e5),n=Math.floor(e%36e5/6e4),a=Math.floor(e%6e4/1e3);return"".concat(t,"d ").concat(r,"h ").concat(n,"m ").concat(a,"s")}function ke(e,t){return e.mul(ye[t]).div(8760)}function Se(e,t,r){var n=I.O$.from(Math.floor(Date.now()/1e3)),a=I.O$.from(r);if(n.gt(t.add(a)))return I.O$.from(0);var i=n.sub(t),s=e.mul(i).div(a);return e.sub(s)}function Ze(){var e=(0,x.Z)(["\n  query Bidders($id: String) {\n    bidder(id: $id) {\n      bids {\n        parcel {\n          id\n          licenseOwner\n          licenseDiamond\n          currentBid {\n            forSalePrice\n            perSecondFeeNumerator\n            perSecondFeeDenominator\n            timestamp\n          }\n          pendingBid {\n            forSalePrice\n            perSecondFeeDenominator\n            perSecondFeeNumerator\n            timestamp\n          }\n          coordinates {\n            pointTL {\n              lon\n              lat\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return Ze=function(){return e},e}!function(e){e[e.WRAP=0]="WRAP",e[e.UNWRAP=1]="UNWRAP"}(ue||(ue={})),function(e){e[e.ASC=0]="ASC",e[e.DESC=1]="DESC"}(de||(de={})),function(e){e.VIEW="View",e.RESPOND="Respond",e.RECLAIM="Reclaim",e.TRIGGER="Trigger"}(pe||(pe={}));var Ce=(0,g.Ps)(Ze());var Ne=function(e){var t=e.accountTokenSnapshot,r=e.account,a=e.ceramic,i=e.registryContract,d=e.setSelectedParcelId,p=e.setInteractionState,m=e.provider,f=e.paymentToken,h=e.showProfile,x=e.disconnectWallet,g=e.handleCloseProfile,y=e.setPortfolioNeedActionCount,j=e.setPortfolioParcelCoords,w=e.isPortfolioToUpdate,k=e.setIsPortfolioToUpdate,S=(0,u.useState)(""),Z=S[0],C=S[1],F=(0,u.useState)(!1),A=F[0],R=F[1],D=(0,u.useState)(!1),B=D[0],O=D[1],Y=(0,u.useState)([]),z=Y[0],H=Y[1],$=(0,u.useState)(),V=$[0],Q=$[1],X=(0,u.useState)(de.DESC),K=X[0],ae=X[1],ie=(0,u.useState)(""),se=ie[0],oe=ie[1],ce=(0,b.a)(Ce,{variables:{id:r}}),le=ce.data,me=ce.refetch;(0,u.useEffect)((function(){var e=!0,t=function(){var t=(0,n.Z)(s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!m||!r){t.next=11;break}return t.prev=1,t.next=4,_(m,r);case 4:n=t.sent,e&&C(n),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}}),[m,r]),(0,u.useEffect)((function(){if(le){var e=!0,t=le.bidder.bids,n=[],a=[],i=!0,s=!1,o=void 0;try{for(var c,l=function(){var e=c.value,t=void 0,i=void 0,s=void 0,o=void 0,l=void 0,u=void 0,d=void 0,p=void 0,f=e.parcel.id,h=e.parcel.licenseOwner,x=e.parcel.currentBid,g=e.parcel.pendingBid,b=e.parcel.coordinates,v=m.getSigner(),y=ve.PCOLicenseDiamondFactory.connect(e.parcel.licenseDiamond,v);if(h===r)!g||I.O$.from(g.forSalePrice).eq(0)?(t="Valid",i="",s=I.O$.from(x.forSalePrice),o=I.O$.from(x.perSecondFeeNumerator),l=I.O$.from(x.perSecondFeeDenominator),p=pe.VIEW):(t="Incoming Bid",i=ge().unix(g.timestamp).add(7,"day").format("YYYY/MM/D"),s=I.O$.from(g.forSalePrice),o=I.O$.from(g.perSecondFeeNumerator),l=I.O$.from(g.perSecondFeeDenominator),p=pe.RESPOND);else{if(!g)return"continue";t="Outgoing Bid",i=ge().unix(g.timestamp).add(7,"day").format("YYYY/MM/D"),s=I.O$.from(g.forSalePrice),o=I.O$.from(g.perSecondFeeNumerator),l=I.O$.from(g.perSecondFeeDenominator),p=pe.VIEW}var j=je(s,o,l);u=j.mul(T.eG),d=ke(u,T.er);var w=ye(f,h),k=new J(w),S=y.contributionRate().then((function(e){if(g&&I.O$.from(g.forSalePrice).gt(0)){var r=g.timestamp+T.p6;(1e3*r<=Date.now()||e.eq(0))&&(t="Needs Tranfer",i=ge().unix(r<Number(g.timestamp)?r:g.timestamp).format("YYYY/MM/D"),s=I.O$.from(g.forSalePrice),o=I.O$.from(g.perSecondFeeNumerator),l=I.O$.from(g.perSecondFeeDenominator),p=pe.TRIGGER)}})).then((function(){return y.isPayerBidActive()})).then((function(e){h!==r||e||(t="In Foreclosure",i=ge().unix(x.timestamp).format("YYYY/MM/D"),s=Se(s,I.O$.from(x.timestamp),T.oq),u=I.O$.from(0),d=I.O$.from(0),p=pe.RECLAIM)})).then((function(){return w.getRecordID("basicProfile")})).then((function(e){return k.setExistingStreamId(e)})).then((function(){var e=k.getStreamContent(),r=e&&e.name?e.name:"Parcel ".concat(f);n.push({parcelId:f,status:t,actionDate:i,name:r,price:s,fee:u,buffer:d,action:p,coords:{lon:b[0].pointTL.lon,lat:b[0].pointTL.lat}})}));a.push(S)},u=t[Symbol.iterator]();!(i=(c=u.next()).done);i=!0)l()}catch(d){s=!0,o=d}finally{try{i||null==u.return||u.return()}finally{if(s)throw o}}return Promise.all(a).then((function(){if(n.length>0){var t=0,r=!0,a=!1,i=void 0;try{for(var s,o=z[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var c=s.value;c.action!==pe.RESPOND&&c.action!==pe.RECLAIM&&c.action!==pe.TRIGGER||t++}}catch(d){a=!0,i=d}finally{try{r||null==o.return||o.return()}finally{if(a)throw i}}var l={price:Ne(n,"price"),fee:Ne(n,"fee"),buffer:Ne(n,"buffer")},u=Pe(n,"parcelId");e&&(y(t),Q(l),H(u))}})),function(){e=!1}}}),[le]),(0,u.useEffect)((function(){w&&(setTimeout((function(){return me({id:r})}),5e3),k(!1))}),[w]);var xe=(0,u.useMemo)((function(){return{address:f.address,symbol:T.RU,decimals:18,image:"",size:"small"}}),[f.address]),ye=function(e,t){if(null!=a&&a.did){var r=new ee.xW({chainId:"eip155:".concat(T.er),assetName:{namespace:"erc721",reference:i.address.toLowerCase()},tokenId:new(L())(e.slice(2),"hex").toString(10)}),n=new ee.hX({chainId:"eip155:".concat(T.er),address:t}),s=new re.v({ceramic:a,aliases:te.model});return new ne(a,s,"did:pkh:".concat(n.toString()),r)}console.error("Ceramic instance not found")},we=function(){var e=(0,n.Z)(s().mark((function e(t,n){var a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,n!==ue.WRAP){e.next=8;break}return e.next=4,f.upgrade({amount:P.fi(t).toString()}).exec(m.getSigner());case 4:a=e.sent,R(!0),e.next=13;break;case 8:if(n!==ue.UNWRAP){e.next=13;break}return e.next=11,f.downgrade({amount:P.fi(t).toString()}).exec(m.getSigner());case 11:a=e.sent,O(!0);case 13:if(e.prev=13,null!==a){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,a.wait();case 18:return e.next=20,_(m,r);case 20:i=e.sent,C(i),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(13),console.error(e.t0);case 27:n===ue.WRAP?R(!1):n===ue.UNWRAP&&O(!1);case 28:case"end":return e.stop()}}),e,null,[[13,24]])})));return function(t,r){return e.apply(this,arguments)}}(),Ze=function(){var e=(0,n.Z)(s().mark((function e(t,r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.target[0].value,Number.isNaN(n)||!(n>0)){e.next=6;break}return e.next=5,we(n,r);case 5:t.target.reset();case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Ne=function(e,t){return e.map((function(e){return e[t]})).reduce((function(e,t){return e.add(t)}))},Pe=function(e,t){var r=(0,he.Z)(e).sort((function(e,r){var n=0;return t!==se||K===de.ASC?n=e[t]>r[t]?1:-1:K===de.DESC&&(n=e[t]>r[t]?-1:1),n}));return ae(t!==se||K===de.ASC?de.DESC:de.ASC),oe(t),r};return(0,o.jsxs)(M.Z,{show:h,keyboard:!1,centered:!0,onHide:g,size:"xl",contentClassName:"bg-dark",children:[(0,o.jsx)(M.Z.Header,{className:"bg-dark border-0",children:(0,o.jsx)(fe.Z,{children:(0,o.jsxs)(E.Z,{children:[(0,o.jsxs)(v.Z,{className:"text-light fs-1 d-flex align-items-center",sm:"10",children:["Account: ",G(r,14),(0,o.jsx)(l.Z,{onClick:function(){x(),g()},variant:"info",className:"ms-4",children:"Disconnect"})]}),(0,o.jsx)(v.Z,{sm:"2",className:"text-end",children:(0,o.jsx)(l.Z,{variant:"link",size:"sm",onClick:function(){return g()},children:(0,o.jsx)(c.Z,{style:{width:"36px"},src:"close.svg"})})})]})})}),(0,o.jsxs)(M.Z.Body,{className:"bg-dark text-light text-start",children:[(0,o.jsx)(E.Z,{children:(0,o.jsxs)(v.Z,{className:"mx-2 fs-6",children:[(0,o.jsx)(c.Z,{src:"notice.svg",className:"me-2"}),t&&t.maybeCriticalAtTimestamp&&Number(t.maybeCriticalAtTimestamp)>Date.now()/1e3?"At the current rate, your ETHx balance will reach 0 on ".concat(ge().unix(t.maybeCriticalAtTimestamp).format("MMM D, YYYY h:mmA.")):"Your ETHx balance is 0. Any Geo Web parcels you previously licensed have been put in foreclosure."]})}),(0,o.jsxs)(E.Z,{className:"mt-3",children:[(0,o.jsxs)(v.Z,{className:"p-3 ms-3 fs-6 border border-purple rounded",sm:"3",children:[(0,o.jsx)("span",{style:{marginLeft:"15px"},children:"ETH: ".concat(Z)}),(0,o.jsxs)(N.Z,{id:"wrapForm",className:"form-inline",noValidate:!0,onSubmit:function(e){return Ze(e,ue.WRAP)},style:{marginTop:"46px",marginLeft:"15px",width:"218px"},children:[(0,o.jsx)(N.Z.Control,{required:!0,autoFocus:!0,type:"text",className:"mb-2",id:"amount",placeholder:"0.00",size:"sm"}),(0,o.jsx)(l.Z,{variant:"secondary",type:"submit",disabled:A,size:"sm",className:"w-100",children:A?"Wrapping...":"Wrap"})]})]}),(0,o.jsx)(v.Z,{sm:"1",className:"p-0 mt-auto mb-auto d-flex justify-content-center",children:(0,o.jsx)(c.Z,{src:"exchange.svg"})}),(0,o.jsxs)(v.Z,{className:"p-3 fs-6 border border-purple rounded",sm:"3",children:[(0,o.jsxs)("div",{style:{marginLeft:"15px"},children:["".concat(T.RU,": "),(0,o.jsx)(U,{format:function(e){return P.bM(e)},accountTokenSnapshot:t})]}),(0,o.jsx)("div",{style:{maxWidth:"220px",height:"auto",margin:"5px 0px 8px 15px"},children:(0,o.jsx)(q,{options:xe})}),(0,o.jsxs)(N.Z,{noValidate:!0,onSubmit:function(e){return Ze(e,ue.UNWRAP)},style:{width:"220px",marginLeft:"15px"},children:[(0,o.jsx)(N.Z.Control,{required:!0,autoFocus:!0,type:"text",className:"mb-2",placeholder:"0.00",size:"sm"}),(0,o.jsx)(l.Z,{variant:"primary",type:"submit",disabled:B,size:"sm",className:"w-100",children:A?"Unwrapping...":"Unwrap"})]})]})]}),(0,o.jsx)(E.Z,{className:"mt-3 ps-3 fs-1",children:"Portfolio"}),(0,o.jsx)(E.Z,{className:"scrollable-table",children:V&&z.length>0?(0,o.jsxs)(be.Z,{bordered:!0,className:"m-3 text-light border border-purple flex-shrink-1",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{onClick:function(){return H(Pe(z,"parcelId"))},children:"Parcel ID"}),(0,o.jsx)("th",{onClick:function(){return H(Pe(z,"status"))},children:"Status"}),(0,o.jsx)("th",{onClick:function(){return H(Pe(z,"actionDate"))},children:"Action Date"}),(0,o.jsx)("th",{onClick:function(){return H(Pe(z,"name"))},children:"Name"}),(0,o.jsx)("th",{onClick:function(){return H(Pe(z,"price"))},children:"Price|Bid"}),(0,o.jsx)("th",{onClick:function(){return H(Pe(z,"fee"))},children:"Fee/Yr"}),(0,o.jsx)("th",{onClick:function(){return H(Pe(z,"buffer"))},children:"Buffer Deposit"}),(0,o.jsx)("th",{onClick:function(){return H(Pe(z,"action"))},children:"Action"})]})}),(0,o.jsxs)("tbody",{children:[z.map((function(e,t){return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:e.parcelId}),(0,o.jsx)("td",{className:"Valid"===e.status||"Outgoing Bid"===e.status?"":"text-danger",children:e.status}),(0,o.jsx)("td",{className:"Valid"===e.status||"Outgoing Bid"===e.status?"":"text-danger",children:e.actionDate}),(0,o.jsx)("td",{children:e.name}),(0,o.jsx)("td",{children:W(P.dF(e.price),8)}),(0,o.jsx)("td",{children:e.action===pe.RECLAIM?"":W(P.dF(e.fee),8)}),(0,o.jsx)("td",{children:e.action===pe.RECLAIM?"":W(P.dF(e.buffer),8)}),(0,o.jsx)("td",{children:(0,o.jsx)(l.Z,{variant:e.action===pe.VIEW?"primary":"danger",className:"w-100",onClick:function(){return function(e){switch(e.action){case pe.VIEW:case pe.RESPOND:case pe.TRIGGER:p(Wt.PARCEL_SELECTED);break;case pe.RECLAIM:p(Wt.PARCEL_RECLAIMING)}d(e.parcelId),j(e.coords)}(e)},children:e.action})})]},t)})),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-center",colSpan:4,children:"Total"}),(0,o.jsx)("td",{children:W(P.dF(V.price),8)}),(0,o.jsx)("td",{children:W(P.dF(V.fee),8)}),(0,o.jsx)("td",{children:W(P.dF(V.buffer),8)}),(0,o.jsx)("td",{})]})]})]}):(0,o.jsx)("span",{style:{height:"128px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:"No parcel yet..."})})]})]})};var Pe=function(e){var t=e.account,r=e.ceramic,n=e.registryContract,i=e.paymentToken,s=e.provider,c=e.disconnectWallet,l=e.setSelectedParcelId,d=e.setInteractionState,p=e.setPortfolioNeedActionCount,m=e.setPortfolioParcelCoords,f=e.isPortfolioToUpdate,h=e.setIsPortfolioToUpdate,x=(0,a.Z)(u.useState(!1),2),g=x[0],b=x[1],y=O.hm.useAccountTokenSnapshotsQuery({chainId:T.er,filter:{account:t,token:i.address}}),j=y.isLoading,w=y.data;return j?(0,o.jsx)(Y.Z,{animation:"border",role:"status"}):(0,o.jsxs)(C.Z,{border:"secondary",className:"bg-dark my-5",children:[(0,o.jsx)(C.Z.Header,{children:(0,o.jsx)("h5",{className:"font-weight-bold",children:"Important Note on Streaming Funds"})}),(0,o.jsx)(C.Z.Body,{children:(0,o.jsxs)(fe.Z,{className:"p-0",children:[(0,o.jsx)(E.Z,{children:(0,o.jsx)(v.Z,{children:(0,o.jsxs)("p",{children:["Your current ETHx balance is"," ",w?(0,o.jsx)(U,{format:function(e){return W(P.bM(e),8)+" ETHx."},accountTokenSnapshot:w.items[0]}):"--",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"Your parcels will be put in foreclosure auctions if your ETHx balance reaches 0 or you cancel your corresponding network fee streams. Make sure to keep a sufficient ETHx balance at all times!"]})})}),(0,o.jsx)(E.Z,{children:(0,o.jsxs)(v.Z,{children:[(0,o.jsx)("p",{className:"text-primary cursor-pointer",onClick:function(){b(!0)},children:"Review your streaming payment dashboard"}),w&&(0,o.jsx)(Ne,{accountTokenSnapshot:w.items[0],account:t,ceramic:r,registryContract:n,paymentToken:i,provider:s,disconnectWallet:c,showProfile:g,handleCloseProfile:function(){return b(!1)},setSelectedParcelId:l,setInteractionState:d,setPortfolioNeedActionCount:p,setPortfolioParcelCoords:m,isPortfolioToUpdate:f,setIsPortfolioToUpdate:h})]})})]})})]})};var Ie=function(e){var t=e.existingAnnualNetworkFee,r=void 0===t?I.O$.from(0):t,i=e.newAnnualNetworkFee,c=e.account,l=e.interactionState,d=e.licenseOwner,p=e.provider,m=e.isFairLaunch,f=e.claimPayment,h=e.collateralDeposit,x=e.currentForSalePrice,g=e.penaltyPayment,b=(0,a.Z)(u.useState(T.er),2),v=b[0],y=b[1];u.useEffect((function(){(0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getNetwork();case 2:t=e.sent.chainId,y(t);case 4:case"end":return e.stop()}}),e)})))()}),[p]);var j,w=null!=i,k=!h&&!f,S=i?i.sub(r):I.O$.from(0),Z=!k&&i?i:null!==S&&void 0!==S?S:I.O$.from(0),C=W(B(Z),18),N=ke(Z,v),E=W(B(N),18);if(f)j=(0,o.jsxs)("p",{children:[m?"Max Claim Payment (to Treasury): ":l==Wt.PARCEL_RECLAIMING&&c.toLowerCase()!=(null===d||void 0===d?void 0:d.toLowerCase())?"Max Claim Payment (to Licensor): ":"Claim Payment: ",(0,o.jsx)(D,{content:(0,o.jsx)("div",{style:{textAlign:"left"},children:l==Wt.PARCEL_RECLAIMING&&c.toLowerCase()===(null===d||void 0===d?void 0:d.toLowerCase())?"No one-time payment is required to reclaim your foreclosed parcel\u2014just restart a network fee stream.":m||l==Wt.PARCEL_RECLAIMING?"This is the amount you authorize for your claim payment. You'll only pay the Dutch auction price at the time of transaction confirmation.":"Unclaimed parcels do not require a one-time payment after the conclusion of the Fair Launch Auction. Network fee payments still apply."}),target:(0,o.jsxs)("span",{style:{textDecoration:"underline"},children:[W(P.dF(f),8)," ",T.RU]})})]});else if(h&&x){var F=B(h),L=B(x),A=B(h.sub(x));j=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{children:["Collateral Deposit:"," ",(0,o.jsx)(D,{content:(0,o.jsx)("div",{style:{textAlign:"left"},children:"Bids must be fully collateralized. If your bid is rejected, this full amount will be returned."}),target:(0,o.jsxs)("span",{style:{textDecoration:"underline"},children:[F," ",T.RU]})})]}),(0,o.jsxs)("p",{children:["\u2003Purchase Payment:"," ",(0,o.jsx)(D,{content:(0,o.jsx)("div",{style:{textAlign:"left"},children:"This is the amount that will be transferred to the current licensor if they accept your bid."}),target:(0,o.jsxs)("span",{style:{textDecoration:"underline"},children:[L," ",T.RU]})})]}),(0,o.jsxs)("p",{children:["\u2003Refundable Collateral:"," ",(0,o.jsx)(D,{content:(0,o.jsx)("div",{style:{textAlign:"left"},children:"This is the amount that will be returned to you if your bid is accepted."}),target:(0,o.jsxs)("span",{style:{textDecoration:"underline"},children:[A," ",T.RU]})})]})]})}else if(g){var R=B(g);j=(0,o.jsxs)("p",{children:["Penalty Payment:"," ",(0,o.jsx)(D,{content:(0,o.jsx)("div",{style:{textAlign:"left"},children:"This is the amount you must pay to the Geo Web treasury to reject the incoming bid (10% of the bidder\u2019s For Sale Price). This penalty is enforced to discourage underpricing of your parcel(s)."}),target:(0,o.jsxs)("span",{style:{textDecoration:"underline"},children:[R," ",T.RU]})})]})}var G=(0,o.jsxs)("p",{children:["Stream:"," ",(0,o.jsx)(D,{content:(0,o.jsx)("div",{style:{textAlign:"left"},children:h?"This is the amount you authorize your network fee stream to be increased if your bid is accepted.":"The amount that will be added (or subtracted) from your total network fee stream."}),target:(0,o.jsx)("span",{style:{textDecoration:"underline"},children:w?"".concat(C," ").concat(T.RU,"/year"):"N/A"})})]}),M=(0,o.jsxs)("p",{children:["Stream Buffer:"," ",(0,o.jsx)(D,{content:(0,o.jsx)("div",{style:{textAlign:"left"},children:h?(0,o.jsxs)(o.Fragment,{children:["This is the amount you authorize to add to your buffer deposit if your bid is accepted.",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"It is used to incentivize closing your stream(s) if your ETHx balance reaches 0."]}):(0,o.jsxs)(o.Fragment,{children:["This is the required adjustment to your stream buffer deposit.",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"It is used to incentivize closing your stream(s) if your ETHx balance reaches 0."]})}),target:(0,o.jsx)("span",{style:{textDecoration:"underline"},children:w?"".concat(E," ").concat(T.RU):"N/A"})})]});return(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{children:"Transaction Summary"}),(0,o.jsxs)(o.Fragment,{children:[j,G,M]})]})};var Ee=function(e){var t=e.account,r=e.ceramic,i=e.paymentToken,c=e.claimBase1Coord,l=e.claimBase2Coord,d=e.registryContract,p=e.perSecondFeeNumerator,m=e.perSecondFeeDenominator,x=e.isFairLaunch,g=e.requiredBid,b=e.setNewParcel,v=e.provider,y=e.disconnectWallet,j=e.setInteractionState,w=e.setSelectedParcelId,k=e.setPortfolioNeedActionCount,S=e.setPortfolioParcelCoords,Z=e.isPortfolioToUpdate,C=e.setIsPortfolioToUpdate,N=(0,a.Z)(u.useState({isActing:!1,didFail:!1,displayNewForSalePrice:""}),2),E=N[0],F=N[1],A=(0,a.Z)(u.useState(""),2),R=A[0],D=A[1],G=E.displayNewForSalePrice,W=null!=G&&G.length>0&&isNaN(Number(G)),M=!W&&G?je(P.fi(G),p,m):null,B=!W&&G?je(P.fi(G),p.mul(T.eG),m):null,_=M?ke(M,T.er):null;function O(){return(O=(0,n.Z)(s().mark((function e(){var t,r,n,a,i,o,u,p,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c&&l){e.next=2;break}throw new Error("Unknown coordinates");case 2:if(t=me.BN.fromXandY(c.x,c.y,_t,Bt),r=me.BN.fromXandY(l.x,l.y,_t,Bt),0==(n=me.BN.makeRectPath(t,r)).length&&(n=[I.O$.from(0)]),G&&M&&!W){e.next=8;break}throw new Error("displayNewForSalePrice is invalid: ".concat(G));case 8:return a=v.getSigner(),e.next=11,d.connect(a).claim(M,P.fi(G),I.O$.from(t.toString()),n);case 11:return i=e.sent,e.next=14,i.wait();case 14:return o=e.sent,u=d.filters.ParcelClaimed(null,null),e.next=18,d.queryFilter(u,o.blockNumber,o.blockNumber);case 18:return p=e.sent,m=p[0].args[0].toString(),b((function(e){return(0,h.Z)((0,f.Z)({},e),{id:"0x".concat(new(L())(m.toString()).toString(16))})})),e.abrupt("return",m);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return u.useEffect((function(){var e=function(){var e=(0,n.Z)(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.getNextProxyAddress(t);case 2:r=e.sent,D(r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[d,t]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(le,(0,f.Z)({loading:!1,performAction:function(){return O.apply(this,arguments)},actionData:E,setActionData:F,summaryView:B?(0,o.jsx)(Ie,(0,f.Z)({claimPayment:x?g:I.O$.from(0),newAnnualNetworkFee:B},e)):(0,o.jsx)(o.Fragment,{}),requiredPayment:x&&_?g.add(_):_,requiredFlowPermissions:1,spender:d.address,flowOperator:R},e)),(0,o.jsx)(Pe,{account:t,ceramic:r,registryContract:d,paymentToken:i,provider:v,disconnectWallet:y,setSelectedParcelId:w,setInteractionState:j,setPortfolioNeedActionCount:k,setPortfolioParcelCoords:S,isPortfolioToUpdate:Z,setIsPortfolioToUpdate:C})]})};var Te=function(e){var t=e.parcelClaimSize,r=e.setInteractionState;return(0,o.jsx)(C.Z,{className:"bg-purple bg-opacity-25 text-light",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsxs)(C.Z.Text,{className:"d-flex align-items-center",children:[(0,o.jsx)(c.Z,{style:{width:"2rem"},src:"grid.svg"}),(0,o.jsxs)("span",{className:"text-".concat(t>T.YE?"danger":"primary"),children:[t,"/",T.YE," Maximum Coordinates"]})]}),(0,o.jsx)(C.Z.Text,{children:"Single click again to set your parcel shape."}),(0,o.jsx)(C.Z.Text,{children:"Click and drag the map to pan, if needed."}),(0,o.jsx)(l.Z,{variant:"danger",className:"w-100 mb-2",onClick:function(){return r(Wt.VIEWING)},children:"Cancel"})]})})},Fe=r(98878),Le=r.n(Fe);var Ae=function(e){var t,r,i=function(e){R(function(e){return function(t){return(0,f.Z)({},t,e)}}(e))},c=e.parcelData,l=e.provider,d=e.ceramic,p=e.basicProfileStreamManager,m=e.perSecondFeeNumerator,h=e.perSecondFeeDenominator,x=e.paymentToken,g=e.disconnectWallet,b=e.account,v=e.hasOutstandingBid,y=e.licenseDiamondContract,j=e.registryContract,w=e.setSelectedParcelId,k=e.setInteractionState,S=e.setPortfolioNeedActionCount,Z=e.setPortfolioParcelCoords,C=e.isPortfolioToUpdate,N=e.setIsPortfolioToUpdate,E=B(c.currentBid.forSalePrice),F=p?p.getStreamContent():null,L=(0,a.Z)(u.useState({displayCurrentForSalePrice:E,isActing:!1,didFail:!1,displayNewForSalePrice:E||"",parcelName:F?F.name:void 0,parcelWebContentURI:F?F.url:void 0}),2),A=L[0],R=L[1],D=A.displayNewForSalePrice,G=null!=D&&D.length>0&&isNaN(Number(D)),W=E&&m&&h?je(P.fi(E),m,h):null,M=E&&m&&h?je(P.fi(E),m.mul(T.eG),h):null,_=!G&&D&&m&&h?je(P.fi(D),m,h):null,O=!G&&D&&m&&h?je(P.fi(D),m.mul(T.eG),h):null,U=W?ke(W,T.er):null,Y=_?ke(_,T.er):null;function z(){return(z=(0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i({isActing:!0}),y){e.next=3;break}throw new Error("Could not find licenseDiamondContract");case 3:if(W){e.next=5;break}throw new Error("Could not find existingNetworkFee");case 5:if(D&&_&&D!=E){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,y.editBid(_,P.fi(D));case 9:return t=e.sent,e.next=12,t.wait();case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(le,(0,f.Z)({licenseAddress:j.address,loading:!1,performAction:function(){return z.apply(this,arguments)},actionData:A,setActionData:R,summaryView:M&&!v?(0,o.jsx)(Ie,(0,f.Z)({existingAnnualNetworkFee:M,newAnnualNetworkFee:null!==O&&void 0!==O?O:M},e)):(0,o.jsx)(o.Fragment,{}),requiredPayment:Y&&U?Y.sub(U):I.O$.from(0),requiredFlowPermissions:2,spender:null!==(t=null===y||void 0===y?void 0:y.address)&&void 0!==t?t:"",flowOperator:null!==(r=null===y||void 0===y?void 0:y.address)&&void 0!==r?r:""},e)),(0,o.jsx)(Pe,{account:b,ceramic:d,registryContract:j,paymentToken:x,provider:l,disconnectWallet:g,setSelectedParcelId:w,setInteractionState:k,setPortfolioNeedActionCount:S,setPortfolioParcelCoords:Z,isPortfolioToUpdate:C,setIsPortfolioToUpdate:N})]})};var Re=function(e){var t=e.account,r=e.provider,a=e.ceramic,i=e.licenseOwner,c=e.paymentToken,l=e.disconnectWallet,d=e.requiredBid,p=e.perSecondFeeNumerator,m=e.perSecondFeeDenominator,h=e.licenseDiamondContract,x=e.registryContract,g=e.setSelectedParcelId,b=e.setInteractionState,v=e.setPortfolioNeedActionCount,y=e.setPortfolioParcelCoords,j=e.isPortfolioToUpdate,w=e.setIsPortfolioToUpdate,k=(0,u.useState)({isActing:!1,didFail:!1,displayNewForSalePrice:""}),S=k[0],Z=k[1],C=S.displayNewForSalePrice,N=null!=C&&C.length>0&&isNaN(Number(C)),E=!N&&C?je(P.fi(C),p,m):null,F=!N&&C?je(P.fi(C),p.mul(T.eG),m):null,L=E?ke(E,T.er):null;function A(){return(A=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=2;break}throw new Error("Could not find licenseDiamondContract");case 2:if(C&&E&&!N){e.next=4;break}throw new Error("displayNewForSalePrice is invalid: ".concat(C));case 4:throw new Error("TODO: Implement Reclaimer");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(le,(0,f.Z)({licenseAddress:x.address,loading:!1,performAction:function(){return A.apply(this,arguments)},actionData:S,setActionData:Z,summaryView:F?(0,o.jsx)(Ie,(0,f.Z)({claimPayment:t.toLowerCase()==(null===i||void 0===i?void 0:i.toLowerCase())?I.O$.from("0"):d,newAnnualNetworkFee:F},e)):(0,o.jsx)(o.Fragment,{}),requiredPayment:d&&L?d.add(L):L,requiredFlowPermissions:1,spender:(null===h||void 0===h?void 0:h.address)||null,flowOperator:(null===h||void 0===h?void 0:h.address)||null},e)),(0,o.jsx)(Pe,{account:t,ceramic:a,registryContract:x,paymentToken:c,provider:r,disconnectWallet:l,setSelectedParcelId:g,setInteractionState:b,setPortfolioNeedActionCount:v,setPortfolioParcelCoords:y,isPortfolioToUpdate:j,setIsPortfolioToUpdate:w})]})},De=r(62515),Ge=r(81362),We=r(81972),Me=r(97241),Be=r(83732),_e=r(9669),Oe=r.n(_e),Ue=function(e){(0,V.Z)(r,e);var t=(0,Q.Z)(r);function r(e,n){var a;return(0,$.Z)(this,r),(a=t.call(this,e.ceramic,e.model.getSchemaURL("Pinset"),e.controller)).web3Storage=new Me.xk({token:("",""),endpoint:new URL("https://api.web3.storage")}),a.assetContentManager=e,a._ipfs=n,a}var a=r.prototype;return a.createOrUpdateStream=function(e){var t=this;return(0,n.Z)(s().mark((function r(){var n;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.assetContentManager.set("geoWebPinset",e);case 2:if(n=r.sent,t.stream){r.next=7;break}return r.next=6,t.assetContentManager.getRecord("geoWebPinset");case 6:t.stream=r.sent;case 7:return r.abrupt("return",n);case 8:case"end":return r.stop()}}),r)})))()},a.updateStream=function(e){var t=this;return(0,n.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.createOrUpdateStream(e);case 1:case"end":return r.stop()}}),r)})))()},a.fetchOrProvisionBucket=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.getStreamContent())||!r.root){t.next=7;break}return e.bucketRoot=Ge.CID.parse(r.root.split("ipfs://")[1]),t.next=5,e.fetchLatestPinset();case 5:t.next=13;break;case 7:return t.next=9,e._ipfs.object.new({template:"unixfs-dir"});case 9:return e.bucketRoot=t.sent,t.next=12,e._ipfs.object.links(e.bucketRoot);case 12:e.latestQueuedLinks=t.sent.map((function(e){return e.Hash}));case 13:case"end":return t.stop()}}),t)})))()},a.reset=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.debug("Resetting pinset..."),t.next=3,e._ipfs.object.new({template:"unixfs-dir"});case 3:return r=t.sent,t.next=6,e.createOrUpdateStream({root:"ipfs://".concat(r.toString())});case 6:return t.next=8,e.fetchOrProvisionBucket();case 8:console.debug("Pinset is reset.");case 9:case"end":return t.stop()}}),t)})))()},a.fetchLatestPinset=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r,n,a,i,o,c,l,u,d,p;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.bucketRoot){t.next=2;break}return t.abrupt("return");case 2:return r=e._ipfs.object.links(e.bucketRoot),n=new Promise((function(e){setTimeout(e,3e3,null)})),console.debug("Finding links for latest pinset: ".concat(e.bucketRoot)),t.next=7,Promise.race([r,n]);case 7:if(!(a=t.sent)){t.next=12;break}e.latestQueuedLinks=a.map((function(e){return e.Hash})),console.debug("Found latestQueuedLinks: ".concat(e.latestQueuedLinks)),t.next=31;break;case 12:return console.warn("Could not find pinset locally: ".concat(e.bucketRoot)),console.debug("Fetching CAR from Web3.storage: ".concat(e.bucketRoot)),t.next=16,Oe().get("https://api.web3.storage/car/".concat(e.bucketRoot.toString()),{responseType:"blob"});case 16:return i=t.sent,console.debug("Importing CAR from Web3.storage: ".concat(e.bucketRoot)),o=i.data,t.next=21,o.arrayBuffer();case 21:return c=t.sent,l=new Uint8Array(c),e._ipfs.dag.import((0,De.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l;case 2:case"end":return e.stop()}}),e)})))()),console.debug("Finding links for latest pinset: ".concat(e.bucketRoot)),t.next=27,e._ipfs.object.links(e.bucketRoot);case 27:return u=t.sent,e.latestQueuedLinks=u.map((function(e){return e.Hash})),console.debug("Found latestQueuedLinks: ".concat(e.latestQueuedLinks)),t.abrupt("return");case 31:return t.prev=31,t.next=34,e.checkWeb3Storage();case 34:t.sent?e.latestPinnedLinks=e.latestQueuedLinks:e.triggerPin(),t.next=41;break;case 38:return t.prev=38,t.t0=t.catch(31),t.abrupt("return");case 41:if(d=localStorage.getItem(e.localPinsetKey()),!(p=d?Ge.CID.parse(d):void 0)){t.next=49;break}return console.debug("Finding links for latest pinned pinset: ".concat(p)),t.next=47,e._ipfs.object.links(p);case 47:e.latestPinnedLinks=t.sent.map((function(e){return e.Hash})),console.debug("Found latestPinnedLinks: ".concat(e.latestPinnedLinks));case 49:case"end":return t.stop()}}),t,null,[[31,38]])})))()},a.localPinsetKey=function(){return"latestPinset:".concat(this.assetContentManager.assetId.toString())},a.checkWeb3Storage=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.bucketRoot){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.web3Storage.status(e.bucketRoot.toString());case 4:return r=t.sent,(n=!!r&&r.pins.length>0)&&localStorage.setItem(e.localPinsetKey(),e.bucketRoot.toString()),t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})))()},a.triggerPin=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.bucketRoot){t.next=2;break}return t.abrupt("return");case 2:return r=e._ipfs.dag.export(e.bucketRoot),t.next=5,Be.tL.fromIterable(r);case 5:return a=t.sent,t.next=8,e.web3Storage.putCar(a);case 8:return e.fetchLatestPinset(),t.next=11,new Promise((function(t){var r=5e3,a=function(){var i=(0,n.Z)(s().mark((function i(){return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.checkWeb3Storage();case 2:i.sent?(e.latestPinnedLinks=e.latestQueuedLinks,t()):(setTimeout((0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),r),r*=1.5);case 4:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}();a()}));case 11:case"end":return t.stop()}}),t)})))()},a.addCid=function(e,t){var r=this;return(0,n.Z)(s().mark((function n(){var a,i,o,c,l,u;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.bucketRoot){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,r._ipfs.object.get(r.bucketRoot);case 4:return a=n.sent,n.next=7,r._ipfs.object.links(r.bucketRoot);case 7:if(!((i=n.sent).filter((function(t){return t.Name==e})).length>0)){n.next=11;break}return console.debug("Link is already in pinset: ".concat(e)),n.abrupt("return");case 11:return n.next=13,r._ipfs.object.stat(t);case 13:return o=n.sent,c=(0,We.createLink)(e,o.CumulativeSize,t),i.push(c),i.sort((function(e,t){var r;return null!==(u=null===(r=e.Name)||void 0===r?void 0:r.localeCompare(null!==(l=t.Name)&&void 0!==l?l:""))&&void 0!==u?u:0})),n.next=20,r._ipfs.object.put((0,h.Z)((0,f.Z)({},a),{Links:i}));case 20:return r.bucketRoot=n.sent,n.next=23,r._ipfs.object.links(r.bucketRoot);case 23:return r.latestQueuedLinks=n.sent.map((function(e){return e.Hash})),n.next=26,r.createOrUpdateStream({root:"ipfs://".concat(r.bucketRoot.toString())});case 26:case"end":return n.stop()}}),n)})))()},a.removeCid=function(e){var t=this;return(0,n.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.bucketRoot){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,t._ipfs.object.patch.rmLink(t.bucketRoot,e);case 4:return t.bucketRoot=r.sent,r.next=7,t._ipfs.object.links(t.bucketRoot);case 7:return t.latestQueuedLinks=r.sent.map((function(e){return e.Hash})),r.next=10,t.createOrUpdateStream({root:"ipfs://".concat(t.bucketRoot.toString())});case 10:return r.next=12,t.triggerPin();case 12:case"end":return r.stop()}}),r)})))()},a.isPinned=function(e){return!!this.latestPinnedLinks&&this.latestPinnedLinks.filter((function(t){return t.equals(e)})).length>0},a.isQueued=function(e){return!!this.latestQueuedLinks&&this.latestQueuedLinks.filter((function(t){return t.equals(e)})).length>0},a.getBucketLink=function(){var e=this;return(0,n.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.bucketRoot?"https://dweb.link/ipfs/".concat(e.bucketRoot.toString()):null);case 1:case"end":return t.stop()}}),t)})))()},r}(K),Ye=r(71658),ze=r.n(Ye),qe=function(){function e(t,r,n){(0,$.Z)(this,e),this._geoWebBucket=t,this._ipfs=r,this.succeededPins=new Set,this.failedPins=new Set,this._perf=n,this.pinningQueue=new(ze())({concurrent:1,interval:500}),this.pinningQueue.start()}var t=e.prototype;return t.retryPin=function(){var e=this;return(0,n.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._geoWebBucket.latestQueuedLinks&&e._geoWebBucket.latestQueuedLinks.forEach((function(t){e.isPinned(t)||e.failedPins.delete(t)})),t.prev=1,t.next=4,e._geoWebBucket.triggerPin();case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),e.queueDidFail();case 9:case"end":return t.stop()}}),t,null,[[1,6]])})))()},t.pinCid=function(e,t){var r=this;return(0,n.Z)(s().mark((function a(){return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,new Promise((function(a,i){r.pinningQueue.enqueue((0,n.Z)(s().mark((function n(){var o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.debug("Pinning: ".concat(e,", ").concat(t)),(o=r._perf.trace("pin_cid")).start(),r.failedPins.delete(t),n.prev=4,n.next=7,r._geoWebBucket.addCid(e,t);case 7:a(),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(4),i(n.t0);case 13:r._geoWebBucket.triggerPin().then((function(){r.succeededPins.add(t),o.putAttribute("success","true"),o.stop()})).catch((function(e){console.warn(e),r.failedPins.add(t),o.putAttribute("success","false"),o.stop()})),console.debug("Pin complete: ".concat(e,", ").concat(t));case 15:case"end":return n.stop()}}),n,null,[[4,10]])}))))}));case 2:case"end":return a.stop()}}),a)})))()},t.unpinCid=function(e){var t=this;return(0,n.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,new Promise((function(r,a){t.pinningQueue.enqueue((0,n.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.debug("Removing pin: ".concat(e)),n.prev=1,n.next=4,t._geoWebBucket.removeCid(e);case 4:r(),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(1),a(n.t0);case 10:console.debug("Pin removed: ".concat(e));case 11:case"end":return n.stop()}}),n,null,[[1,7]])}))))}));case 2:case"end":return r.stop()}}),r)})))()},t.isPinned=function(e){return this._geoWebBucket.isPinned(e)},t.isQueued=function(e){return this._geoWebBucket.isQueued(e)},t.latestQueuedLinks=function(){return this._geoWebBucket.latestQueuedLinks},t.queueDidFail=function(){var e=this;console.warn("Current pinset in queue failed"),this._geoWebBucket.latestQueuedLinks&&this._geoWebBucket.latestQueuedLinks.forEach((function(t){e.isPinned(t)||e.failedPins.add(t)}))},t.reset=function(){var e=this;return(0,n.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._geoWebBucket.reset());case 1:case"end":return t.stop()}}),t)})))()},t.getLink=function(){var e=this;return(0,n.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._geoWebBucket.getBucketLink();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},t.getStorageLimit=function(){return 5e8},t.getStorageUsed=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r,n,a,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._geoWebBucket.bucketRoot){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e._ipfs.object.stat(e._geoWebBucket.bucketRoot);case 4:return r=t.sent,t.next=7,e._ipfs.object.links(e._geoWebBucket.bucketRoot);case 7:return n=t.sent,a=n.reduce((function(e,t){var r=e;return t.Tsize?r[t.Hash.toString()]=t.Tsize:delete r[t.Hash.toString()],r}),{}),i=Object.values(a).reduce((function(e,t){return e+t}),0),t.abrupt("return",i+r.BlockSize);case 11:case"end":return t.stop()}}),t)})))()},e}();var He=r(71604),$e=r(45785),Ve=r(82662),Qe=function(e){(0,V.Z)(r,e);var t=(0,Q.Z)(r);function r(e,n){var a;return(0,$.Z)(this,r),(a=t.call(this,e.ceramic,e.model.getSchemaURL("MediaObject"),e.controller)).assetContentManager=e,a.mediaGalleryStreamManager=n,a}var a=r.prototype;return a.setMediaGalleryStreamManager=function(e){var t=this;return(0,n.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.mediaGalleryStreamManager=e;case 1:case"end":return r.stop()}}),r)})))()},a.createOrUpdateStream=function(e){var t=this,a=this;return(0,n.Z)(s().mark((function n(){var i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,$e.Z)((0,Ve.Z)(r.prototype),"createOrUpdateStream",t).call(a,e,a._controller,!1);case 2:return i=n.sent,n.abrupt("return",i);case 4:case"end":return n.stop()}}),n)})))()},a.addToMediaGallery=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r,n,a,i,o,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.mediaGalleryStreamManager){t.next=3;break}return console.error("MediaGalleryStreamManager does not exist"),t.abrupt("return");case 3:if(null!=(r=e.getStreamId())){t.next=7;break}return console.error("MediaGalleryItemStreamManager.streamId does not exist"),t.abrupt("return");case 7:return a=null!==(n=e.mediaGalleryStreamManager.getStreamContent())&&void 0!==n?n:{mediaGalleryItems:[]},o=null!==(i=a.mediaGalleryItems)&&void 0!==i?i:[],c=o.concat(r.toString()),t.next=14,e.mediaGalleryStreamManager.createOrUpdateStream({mediaGalleryItems:c});case 14:case"end":return t.stop()}}),t)})))()},a.removeFromMediaGallery=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r,n,a,i,o,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.getStreamId()){t.next=3;break}return t.abrupt("return");case 3:if(e.mediaGalleryStreamManager){t.next=6;break}return console.error("MediaGalleryStreamManager does not exist"),t.abrupt("return");case 6:return a=null!==(n=e.mediaGalleryStreamManager.getStreamContent())&&void 0!==n?n:{mediaGalleryItems:[]},o=null!==(i=a.mediaGalleryItems)&&void 0!==i?i:[],c=o.filter((function(e){return r.toString()!=e})),t.next=13,e.mediaGalleryStreamManager.createOrUpdateStream({mediaGalleryItems:c});case 13:return t.next=15,e.ceramic.pin.rm(r);case 15:case"end":return t.stop()}}),t)})))()},r}(K);var Xe=r(15503),Ke=(r(90923),{apiKey:"AIzaSyBlEYHLq02ZfZsXQ5I0MXq2nf3QCXWM_14",authDomain:"geo-web-cadastre.firebaseapp.com",projectId:"geo-web-cadastre",storageBucket:"geo-web-cadastre.appspot.com",messagingSenderId:"890300523540",appId:"1:890300523540:web:271b68c3f5d1ea87dd7301"});function Je(){var e=(0,a.Z)(u.useState(null),2),t=e[0],r=e[1];return u.useEffect((function(){try{Xe.Z.app()}catch(t){Xe.Z.initializeApp(Ke)}var e=Xe.Z.performance();r(e)}),[Ke]),{firebasePerf:t}}var et=[{extension:".gif",encoding:"image/gif",type:"ImageObject"},{extension:".glb",encoding:"model/gltf-binary",type:"3DModel"},{extension:".jpeg",encoding:"image/jpeg",type:"ImageObject"},{extension:".mp3",encoding:"audio/mpeg",type:"AudioObject"},{extension:".mp4",encoding:"audio/mp4",type:"AudioObject"},{extension:".mp4",encoding:"video/mp4",type:"VideoObject"},{extension:".mpeg",encoding:"video/mpeg",type:"VideoObject"},{extension:".png",encoding:"image/png",type:"ImageObject"},{extension:".svg",encoding:"image/svg+xml",type:"ImageObject"},{extension:".usdz",encoding:"model/vnd.usdz+zip",type:"3DModel"}],tt=function(e){var t="."+e.split(".").pop(),r={};return et.forEach((function(e){e.extension===t&&(r.encoding=e.encoding,r.type=e.type)})),r};var rt,nt=function(e){var t=function(e){W(function(e){return function(t){return(0,f.Z)({},t,e)}}(e))},r=function(){document.getElementById("galleryForm").reset(),j(null),S(null),W({}),R(!1),d(null)},i=e.mediaGalleryStreamManager,c=e.selectedMediaGalleryItemManager,d=e.setSelectedMediaGalleryItemId,p=e.ipfs,m=e.assetContentManager,h=e.pinningManager,x=e.selectedParcelId,g=e.setSelectedParcelId,b=(0,a.Z)(u.useState(null),2),y=b[0],j=b[1],w=(0,a.Z)(u.useState(null),2),k=w[0],S=w[1],Z=(0,a.Z)(u.useState(!1),2),C=Z[0],P=Z[1],I=(0,a.Z)(u.useState(!1),2),T=I[0],F=I[1],L=(0,a.Z)(u.useState(!1),2),A=L[0],R=L[1],D=(0,a.Z)(u.useState({}),2),G=D[0],W=D[1],M=Je().firebasePerf,B=G.contentUrl?G.contentUrl.replace("ipfs://",""):"";function _(){return(_=(0,n.Z)(s().mark((function e(r){var n,a,i,o,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.persist(),r.stopPropagation(),r.preventDefault(),n=r.target.files[0]){e.next=6;break}return e.abrupt("return");case 6:return P(!0),a=tt(n.name),i=a.encoding,o=a.type,S(null!==i&&void 0!==i?i:null),e.next=12,p.add(n);case 12:c=e.sent,t({"@type":o,contentUrl:"ipfs://".concat(c.cid.toString()),encodingFormat:i}),P(!1);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return O=(0,n.Z)(s().mark((function e(){var t,n,a,o,c,l,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F(!0),R(!1),null===(t=null===M||void 0===M?void 0:M.trace("add_media_item_to_gallery"))||void 0===t||t.start(),!(G&&m&&i&&h)){e.next=30;break}return a=new Qe(m,i),e.next=9,a.createOrUpdateStream(G);case 9:if(o=null===(n=G.contentUrl)||void 0===n?void 0:n.replace("ipfs://",""),c=o?Ge.CID.parse(o):null,l=c?"".concat(a.getStreamId(),"-").concat(c):null,!c||!l){e.next=24;break}return e.prev=13,e.next=16,h.pinCid(l,c);case 16:e.next=24;break;case 18:return e.prev=18,e.t0=e.catch(13),console.error(e.t0),R(!0),F(!1),e.abrupt("return");case 24:return a.setMediaGalleryStreamManager(i),e.next=27,a.addToMediaGallery();case 27:u=x,g(""),g(u);case 30:r(),null===t||void 0===t||t.stop(),F(!1);case 33:case"end":return e.stop()}}),e,null,[[13,18]])}))),O.apply(this,arguments)}function U(){return(U=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F(!0),!G){e.next=4;break}return e.next=4,null===c||void 0===c?void 0:c.createOrUpdateStream(G);case 4:r(),F(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}u.useEffect((function(){if(c){var e,t=c.getStreamContent();if(W(null!==t&&void 0!==t?t:{}),t)S(null!==(e=t.encodingFormat)&&void 0!==e?e:null)}else W({})}),[c]);var Y,z=G.contentUrl&&G.name&&!T,q=(0,o.jsx)("span",{className:"spinner-border",role:"status",style:{height:"1.5em",width:"1.5em"},children:(0,o.jsx)("span",{className:"visually-hidden"})});return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(N.Z,{id:"galleryForm",className:"pt-2 text-start",children:[(0,o.jsxs)(E.Z,{className:"px-3 d-flex align-items-end",children:[(0,o.jsx)(v.Z,{sm:"12",lg:"6",className:"mb-3",children:(0,o.jsxs)(He.Z,{children:[(0,o.jsx)(N.Z.Control,{style:{backgroundColor:"#111320",border:"none"},className:"text-white mt-1",type:"text",placeholder:"Upload media or add an existing CID",readOnly:C||null!=c,value:B,onChange:function(e){var r=e.target.value;if(!r||0==r.length)return t({contentUrl:void 0}),j(null),void S(null);t({contentUrl:"ipfs://".concat(r),encodingFormat:null!==k&&void 0!==k?k:void 0})}}),(0,o.jsx)(N.Z.Control,{type:"file",id:"uploadCid",style:{backgroundColor:"#111320",border:"none"},className:"mt-1",accept:et.map((function(e){return e.extension})).toString(),disabled:C||null!=c,onChange:function(e){return _.apply(this,arguments)},hidden:!0}),(0,o.jsx)(l.Z,{as:"label",htmlFor:"uploadCid",disabled:C||null!=c,children:C?q:"Upload"})]})}),(0,o.jsx)(v.Z,{sm:"12",lg:"6",className:"mb-3",children:(0,o.jsxs)("div",{children:[(0,o.jsx)(N.Z.Text,{className:"text-primary mb-1",children:"File Format"}),(0,o.jsxs)(N.Z.Control,{as:"select",className:"text-white mt-1",style:{backgroundColor:"#111320",border:"none"},onChange:function(e){var r;S(e.target.value),t({"@type":(r=e.target.value,et.filter((function(e){return e.encoding===r}))[0].type),encodingFormat:e.target.value})},value:null!==(Y=null!==y&&void 0!==y?y:k)&&void 0!==Y?Y:void 0,required:!0,disabled:null!=y,children:[(0,o.jsx)("option",{value:"",selected:!0,children:"Select a File Format"}),et.map((function(e){return(0,o.jsxs)("option",{value:e.encoding,children:[e.extension," (",e.encoding,")"]})}))]})]},"inline-radio")})]}),(0,o.jsxs)(E.Z,{className:"px-3 d-flex align-items-end",children:[(0,o.jsx)(v.Z,{sm:"12",lg:"6",className:"mb-3",children:(0,o.jsx)(N.Z.Control,{style:{backgroundColor:"#111320",border:"none"},className:"text-white mt-1",type:"text",placeholder:"Display Name of Media",value:G.name,required:!0,onChange:function(e){t({name:e.target.value})}})}),(0,o.jsxs)(v.Z,{sm:"12",lg:"6",className:"mb-3",children:[(0,o.jsx)(N.Z.Text,{className:"text-primary mb-1",children:"Content Pinning Service"}),(0,o.jsx)(N.Z.Control,{as:"select",className:"text-white mt-1",style:{backgroundColor:"#111320",border:"none"},onChange:function(){},disabled:!0,children:(0,o.jsx)("option",{value:"buckets",children:"Geo Web Free (Default)"})})]})]}),(0,o.jsxs)(E.Z,{className:"px-3 text-end",children:[(0,o.jsx)(v.Z,{xs:"auto",lg:{offset:6},className:"mb-3",children:(0,o.jsx)(l.Z,{variant:"danger",onClick:r,children:"Cancel"})}),(0,o.jsx)(v.Z,{xs:"auto",children:c?(0,o.jsx)(l.Z,{variant:"secondary",onClick:function(){return U.apply(this,arguments)},children:T?q:"Save Changes"}):(0,o.jsx)(l.Z,{variant:"secondary",disabled:!z,onClick:function(){return O.apply(this,arguments)},children:T?q:"Add to Gallery"})}),A?(0,o.jsx)(v.Z,{className:"text-danger",children:"Failed to add item. An unknown error occurred."}):null]})]})})},at={"3DModel":"3D Model",ImageObject:"Image",VideoObject:"Video",AudioObject:"Audio"};!function(e){e[e.PINNED=0]="PINNED",e[e.PINNING=1]="PINNING",e[e.FAILED=2]="FAILED",e[e.NOT_FOUND=3]="NOT_FOUND"}(rt||(rt={}));var it=function(e){var t,r,i,d=e.pinningManager,p=e.mediaGalleryItemStreamManager,m=e.index,f=e.selectedMediaGalleryItemId,h=e.setSelectedMediaGalleryItemId,x=e.selectedParcelId,g=e.setSelectedParcelId,b=(0,a.Z)(u.useState(!1),2),y=b[0],j=b[1],w=(0,a.Z)(u.useState(!1),2),k=w[0],S=w[1],Z=(0,a.Z)(u.useState(null),2),C=Z[0],N=Z[1],P=!!f&&(null!==(i=f.toString()==(null===(t=p.getStreamId())||void 0===t?void 0:t.toString()))&&void 0!==i?i:null),I=!k&&(y||P),T=p.getStreamContent(),F=null===T||void 0===T||null===(r=T.contentUrl)||void 0===r?void 0:r.replace("ipfs://",""),L=F?Ge.CID.parse(F):null,A=L?"".concat(p.getStreamId(),"-").concat(L):null,R=!(!d||!L)&&d.isPinned(L),D=!(!d||!L)&&d.isQueued(L),G=d?d.failedPins:new Set;u.useEffect((function(){d&&A&&L&&(R?N(rt.PINNED):G.has(A)?N(rt.FAILED):(N(rt.PINNING),D||(console.log("Object ".concat(A," is not in queue. Pinning again...")),d.pinCid(A,L))))}),[d,G.size,R,D]);var W,M=(0,o.jsx)("span",{className:"spinner-border",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden"})});function B(){return(B=(0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),e.next=3,p.removeFromMediaGallery();case 3:if(!A){e.next=6;break}return e.next=6,null===d||void 0===d?void 0:d.unpinCid(A);case 6:S(!1),t=x,g(""),g(t);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===d||void 0===d?void 0:d.retryPin();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return k?W=(0,o.jsxs)(v.Z,{className:"text-white",children:[(0,o.jsx)("h4",{children:"Removing"}),M]}):C==rt.PINNING?W=(0,o.jsxs)(v.Z,{className:"text-white",children:[(0,o.jsx)("h4",{children:"Pinning"}),M]}):C==rt.FAILED?W=(0,o.jsx)(v.Z,{className:"text-white mt-4",children:(0,o.jsx)("h4",{children:"Pin Failed"})}):C==rt.NOT_FOUND&&(W=(0,o.jsx)(v.Z,{className:"text-white mt-4",children:(0,o.jsx)("h4",{children:"File Not Found"})})),(0,o.jsxs)(fe.Z,{onMouseEnter:function(){return j(!0)},onMouseLeave:function(){return j(!1)},className:"text-center p-3 rounded ".concat(I?"border border-secondary":""),children:[(0,o.jsx)(E.Z,{children:(0,o.jsx)(v.Z,{style:W?{opacity:"0.3"}:{},children:(0,o.jsxs)("h1",{style:{fontSize:"1.5em"},children:[m+1,". ",null===T||void 0===T?void 0:T.name]})})}),(0,o.jsx)(E.Z,{children:(0,o.jsxs)(v.Z,{style:{height:"100px"},children:[(0,o.jsx)(c.Z,{style:W?{opacity:"0.3"}:{},src:"file.png"}),(0,o.jsx)("div",{className:"position-relative bottom-100",children:W})]})}),(0,o.jsx)(E.Z,{className:"text-center",style:W?{opacity:"0.3"}:{},children:(0,o.jsx)(v.Z,{children:T&&T["@type"]?(0,o.jsx)("p",{children:at[T["@type"]]}):null})}),I||C!=rt.PINNING?null:(0,o.jsx)(E.Z,{children:(0,o.jsx)("p",{children:"Note: You may navigate from this page & pinning will continue."})}),(0,o.jsxs)(E.Z,{style:{visibility:I?"visible":"hidden"},children:[(0,o.jsx)(v.Z,{className:"mb-3",xs:"12",style:{display:C==rt.FAILED?"inline":"none"},children:(0,o.jsx)(l.Z,{variant:"secondary",onClick:function(){return _.apply(this,arguments)},children:"Retrigger Pin"})}),(0,o.jsx)(v.Z,{children:(0,o.jsx)(l.Z,{variant:"info",onClick:function(){var e,t;h(null!==(t=null===(e=p.getStreamId())||void 0===e?void 0:e.toString())&&void 0!==t?t:null)},disabled:P,children:"Edit"})}),(0,o.jsx)(v.Z,{children:(0,o.jsx)(l.Z,{variant:"danger",onClick:function(){return B.apply(this,arguments)},children:"Delete"})})]})]})};var st=function(e){var t=e.mediaGalleryData,r=e.mediaGalleryItems,n=e.selectedMediaGalleryItemId,a=e.setSelectedMediaGalleryItemId,i=t.flatMap((function(e){return r[e]})).filter((function(e){return e}));return(0,o.jsxs)(E.Z,{className:"p-5 m-3 text-center",style:{backgroundColor:"#111320"},children:[i.map((function(t,r){return(0,o.jsx)(v.Z,{xs:"12",lg:"6",xl:"4",children:(0,o.jsx)(it,(0,h.Z)((0,f.Z)({},e),{mediaGalleryItemStreamManager:t,index:r,selectedMediaGalleryItemId:n,setSelectedMediaGalleryItemId:a}))},r)})),0==i.length?(0,o.jsx)(v.Z,{xs:"12",className:"text-muted",children:"No items in gallery"}):null]})},ot=r(83134),ct=function(e){(0,V.Z)(r,e);var t=(0,Q.Z)(r);function r(e){var n;return(0,$.Z)(this,r),(n=t.call(this,e.ceramic,e.model.getSchemaURL("MediaGallery"),e.controller)).assetContentManager=e,n.loader=new ot.Zp({ceramic:n.ceramic}),n}var a=r.prototype;return a.createOrUpdateStream=function(e){var t=this;return(0,n.Z)(s().mark((function r(){var n;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.assetContentManager.set("mediaGallery",e);case 2:if(n=r.sent,t.stream){r.next=7;break}return r.next=6,t.assetContentManager.getRecord("mediaGallery");case 6:t.stream=r.sent;case 7:return r.abrupt("return",n);case 8:case"end":return r.stop()}}),r)})))()},a.updateStream=function(e){var t=this;return(0,n.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.createOrUpdateStream(e);case 1:case"end":return r.stop()}}),r)})))()},a.loadItems=function(){var e=this;return(0,n.Z)(s().mark((function t(){var r,n,a,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.getStreamContent()){t.next=3;break}return t.abrupt("return",{});case 3:return a=null!==(n=r.mediaGalleryItems)&&void 0!==n?n:[],t.next=7,Promise.all(a.map((function(t){return e.loader.load(t)})));case 7:return i=t.sent,t.abrupt("return",i.reduce((function(e,t){return e[t.id.toString()]=t,e}),{}));case 9:case"end":return t.stop()}}),t)})))()},r}(K);var lt=function(e){var t=e.show,r=e.setInteractionState,i=e.assetContentManager,d=e.pinningManager,p=function(){r(Wt.PARCEL_SELECTED)},m=function(e){var t=(0,a.Z)(u.useState(null),2),r=t[0],i=t[1];return u.useEffect((function(){function t(){return(t=(0,n.Z)(s().mark((function t(){var r,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return i(null),t.abrupt("return");case 3:return r=new ct(e),t.next=6,e.getRecordID("mediaGallery");case 6:return n=t.sent,console.debug("Setting up mediaGallery: ".concat(n)),t.next=10,r.setExistingStreamId(n);case 10:i(r),console.debug("Setup mediaGallery complete.");case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}i(null),function(){t.apply(this,arguments)}()}),[e]),r}(i),h=function(e,t){var r,i,o=(0,a.Z)(u.useState({}),2),c=o[0],l=o[1],d=e?null!==(r=e.getStreamContent())&&void 0!==r?r:{mediaGalleryItems:[]}:null,p=d&&null!==(i=d.mediaGalleryItems)&&void 0!==i?i:[],m=p?p.length:0;return u.useEffect((function(){function r(){return r=(0,n.Z)(s().mark((function r(){var n,a;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(p&&e&&t){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,e.loadItems();case 4:n=r.sent,a=Object.keys(n).reduce((function(r,a){var i=new Qe(t,e);return i.stream=n[a],r[a]=i,r}),{}),l(a);case 7:case"end":return r.stop()}}),r)}))),r.apply(this,arguments)}!function(){r.apply(this,arguments)}()}),[m,e,t]),{mediaGalleryData:p,mediaGalleryItems:c}}(m,i),x=h.mediaGalleryData,g=h.mediaGalleryItems,b=(0,a.Z)(u.useState(null),2),y=b[0],j=b[1],w=(0,a.Z)(u.useState(null),2),k=w[0],S=w[1],Z=(0,o.jsx)("span",{className:"spinner-border",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})});u.useEffect((function(){var e=g&&y?g[y]:null;S(e)}),[y]);var C,N=(0,a.Z)(u.useState(null),2),P=N[0],I=N[1],T=(0,a.Z)(u.useState(null),2),F=T[0],L=T[1],A=d?d.getStorageLimit():null;C=F&&A?"".concat((F/1e6).toFixed(1)," MB Used"):(0,o.jsxs)(o.Fragment,{children:[Z," MB Used"]}),u.useEffect((function(){function e(){return e=(0,n.Z)(s().mark((function e(){var t,r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,d.getLink();case 4:return t=e.sent,I(t),e.next=9,d.getStorageUsed();case 9:if(e.t1=r=e.sent,e.t0=null!==e.t1,!e.t0){e.next=13;break}e.t0=void 0!==r;case 13:if(!e.t0){e.next=17;break}e.t2=r,e.next=18;break;case 17:e.t2=null;case 18:n=e.t2,L(n);case 20:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[d,g]);var R=null==m||null==d||null==P,D=(0,a.Z)(u.useState(!1),2),G=D[0],W=D[1],B=function(){var e=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W(!0),e.next=3,null===d||void 0===d?void 0:d.reset();case 3:W(!1),p();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=(0,o.jsxs)(M.Z.Body,{className:"bg-dark p-5 text-light text-center",children:[(0,o.jsx)("p",{className:"px-5",children:"The pinset associated to your DID could not be found. If you have constrained connectivity, please refresh this page and try again."}),(0,o.jsx)("p",{className:"px-5 mb-5",children:"If you keep getting this message, your pinset may have been corrupted or lost (the Geo Web is a beta product). Please reset your pinset below and re-add your desired content."}),(0,o.jsx)(l.Z,{size:"lg",onClick:B,variant:"danger",disabled:G,children:G?Z:"Reset Pinset"})]});return(0,o.jsxs)(M.Z,{show:t,backdrop:"static",keyboard:!1,centered:!0,size:"xl",onHide:p,contentClassName:"bg-dark",children:[(0,o.jsx)(M.Z.Header,{className:"bg-dark border-0",children:(0,o.jsx)(fe.Z,{children:(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(v.Z,{sm:"11",children:(0,o.jsx)(M.Z.Title,{className:"text-primary",children:"Edit Media Gallery"})}),(0,o.jsx)(v.Z,{sm:"1",className:"text-end",children:(0,o.jsx)(l.Z,{variant:"link",size:"sm",onClick:p,children:(0,o.jsx)(c.Z,{src:"close.svg"})})})]})})}),R?(0,o.jsxs)(M.Z.Body,{className:"bg-dark p-5 text-light text-center",children:[null==d?(0,o.jsx)("p",{children:"Provisioning Storage For Media Gallery"}):null,Z]}):null==d.latestQueuedLinks()?_:(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(M.Z.Body,{className:"bg-dark px-4 text-light",children:[(0,o.jsxs)("p",{children:["Add content to this structured gallery for easy display on the"," ",(0,o.jsx)("a",{children:"Geo Web Spatial Browser."})]}),(0,o.jsxs)("div",{className:"border border-secondary rounded p-3 text-center",children:[(0,o.jsx)(nt,(0,f.Z)({mediaGalleryStreamManager:m,selectedMediaGalleryItemManager:k,setSelectedMediaGalleryItemId:j},e)),(0,o.jsx)(st,(0,f.Z)({mediaGalleryData:x,mediaGalleryItems:g,selectedMediaGalleryItemId:y,setSelectedMediaGalleryItemId:j},e)),(0,o.jsx)("a",{className:"text-light",href:P,target:"_blank",rel:"noreferrer",children:C})]})]})})]})},ut=r(70178),dt=r.n(ut),pt=r(28734),mt=r.n(pt);ge().extend(dt()),ge().extend(mt());var ft=function(e){var t=e.newForSalePrice,r=e.existingForSalePrice,i=e.bidTimestamp,c=e.licensorIsOwner,d=e.registryContract,p=e.licenseDiamondContract,m=e.selectedParcelId,f=e.perSecondFeeNumerator,h=e.perSecondFeeDenominator,x=e.setInteractionState,g=e.setSelectedParcelId,b=e.setIsPortfolioToUpdate,v=(0,a.Z)(u.useState(!1),2),y=v[0],j=v[1],w=(0,a.Z)(u.useState(!1),2),k=w[0],S=w[1],Z=(0,a.Z)(u.useState(""),2),N=Z[0],P=Z[1],I=W(B(t),18),E=je(r,f,h),F=W(B(r),18),L=(0,a.Z)(u.useState(null),2),A=L[0],R=L[1],D=(0,a.Z)(u.useState(null),2),G=D[0],M=D[1],_=(0,o.jsx)("span",{className:"spinner-border",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})});u.useEffect((function(){function e(){return(e=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d&&p){e.next=2;break}return e.abrupt("return");case 2:return e.t0=R,e.next=5,d.getBidPeriodLengthInSeconds();case 5:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=M,e.next=10,p.contributionRate();case 10:e.t3=e.sent,(0,e.t2)(e.t3);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[d,p]);var O=i&&A?i.add(A):null,U=O?ge()(1e3*O.toNumber()).utc().format("YYYY-MM-DD HH:mm"):null,Y=O&&new Date(1e3*Number(O))<=new Date,z=G&&(G.eq(0)||Y);function q(){return(q=(0,n.Z)(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j(!0),S(!1),p){e.next=4;break}throw new Error("Could not find licenseDiamondContract");case 4:if(t){e.next=6;break}throw new Error("Could not find newForSalePrice");case 6:if(E){e.next=8;break}throw new Error("Could not find existingNetworkFee");case 8:return e.prev=8,e.next=11,p.acceptBid();case 11:return r=e.sent,e.next=14,r.wait();case 14:e.next=23;break;case 16:return e.prev=16,e.t0=e.catch(8),console.error(e.t0),P(e.t0.reason?e.t0.reason.replace("execution reverted: ",""):e.t0.message),S(!0),j(!1),e.abrupt("return");case 23:j(!1),b(!0),x(Wt.PARCEL_SELECTED);case 26:case"end":return e.stop()}}),e,null,[[8,16]])})))).apply(this,arguments)}function H(){return(H=(0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j(!0),S(!1),p){e.next=4;break}throw new Error("Could not find licenseDiamondContract");case 4:return e.prev=4,e.next=7,p.triggerTransfer();case 7:return t=e.sent,e.next=10,t.wait();case 10:e.next=19;break;case 12:return e.prev=12,e.t0=e.catch(4),console.error(e.t0),P(e.t0.errorObject.reason.replace("execution reverted: ","")),S(!0),j(!1),e.abrupt("return");case 19:j(!1),x(Wt.PARCEL_SELECTED),g(""),b(!0),g(m);case 24:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}return(0,o.jsxs)(C.Z,{className:"bg-purple bg-opacity-25 mt-5",children:[(0,o.jsx)(C.Z.Header,{children:(0,o.jsx)("h3",{children:"Outstanding Bid"})}),(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsxs)("p",{children:["For Sale Price (Bid): ",I," ",T.RU]}),(0,o.jsxs)("p",{children:[c?"Payment You'd Receive: ":"Payment to Licensor: "," ",F," ",T.RU]}),(0,o.jsxs)("p",{children:["Response Deadline:"," ",U||_," UTC"]}),c&&!z?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.Z,{variant:"success",className:"w-100 mb-2",disabled:y,onClick:function(){return function(){return q.apply(this,arguments)}()},children:y?_:"Accept Bid"}),(0,o.jsx)(l.Z,{variant:"danger",className:"w-100 mb-2",disabled:y,onClick:function(){return x(Wt.PARCEL_REJECTING_BID)},children:"Reject Bid"})]}):null,z?(0,o.jsx)(l.Z,{variant:"primary",className:"w-100 mb-2",disabled:y,onClick:function(){return function(){return H.apply(this,arguments)}()},children:y?_:"Trigger Transfer"}):null,k&&!y?(0,o.jsx)(ie,{message:N,onClick:function(){return S(!1)}}):null]})]})};var ht=function(){var e=(0,a.Z)(u.useState(!1),2),t=e[0],r=e[1],n=function(){return r(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"d-grid gap-2",children:(0,o.jsx)(l.Z,{variant:"link",className:"fst-italic mt-3",size:"lg",onClick:function(){return r(!0)},children:"How do Geo Web auctions work?"})}),(0,o.jsxs)(M.Z,{show:t,onHide:n,contentClassName:"bg-dark",children:[(0,o.jsxs)(M.Z.Header,{style:{background:"#111320",fontFamily:"Abel",fontSize:"1.5em"},className:"text-primary border-dark",children:[(0,o.jsx)(M.Z.Title,{as:"h2",children:"How Geo Web Auctions Work"}),(0,o.jsx)(l.Z,{variant:"link",size:"sm",onClick:n,children:(0,o.jsx)(c.Z,{src:"close.svg"})})]}),(0,o.jsxs)(M.Z.Body,{className:"bg-dark text-light px-4",children:[(0,o.jsx)("p",{children:"The parcel licensor has 7 days to accept or match (i.e. reject with a penalty) an incoming bid. No other bids or changes to the parcel's For Sale Price are allowed during this time."}),(0,o.jsx)("p",{children:"If the licensor accepts the bid, license of this parcel will transfer to the bidder and they will begin network fee payments based on their new For Sale Price. They will receive payment equal to their previous For Sale Price (not the bid amount!)."}),(0,o.jsx)("p",{children:"If the licensor wants to reject the bid, they must authorize a new For Sale Price equal to or greater than the bid amount. They must also pay a bid matching penalty equal to 2% of their previous For Sale Price."}),(0,o.jsx)("p",{children:"If they do not act upon the bid in the 7 day window, any network participant (including you) may trigger acceptance of the bid and the corresponding actions. The licensor cannot reject a bid after the 7 day window has lapsed."})]})]})]})},xt=(0,o.jsx)(c.Z,{style:{width:"1.1rem",marginLeft:"4px"},src:"info.svg"});var gt=function(e){var t,r,i=e.parcelData,d=e.ceramic,p=e.registryContract,m=e.provider,x=e.perSecondFeeNumerator,g=e.perSecondFeeDenominator,b=e.paymentToken,y=e.disconnectWallet,j=e.account,w=e.licenseDiamondContract,k=e.setSelectedParcelId,S=e.setInteractionState,Z=e.setPortfolioNeedActionCount,I=e.setPortfolioParcelCoords,F=e.isPortfolioToUpdate,L=e.setIsPortfolioToUpdate,A=(0,a.Z)(u.useState(!1),2),R=A[0],G=A[1],M=(0,a.Z)(u.useState(!1),2),_=M[0],O=M[1],U=(0,a.Z)(u.useState(""),2),Y=U[0],z=U[1],q=(0,a.Z)(u.useState(!1),2),$=q[0],V=q[1],Q=(0,a.Z)(u.useState(null),2),X=Q[0],K=Q[1],J=B(i.currentBid.forSalePrice),ee=P.fi(J),te=null!=X&&X.length>0&&!isNaN(Number(X))?P.fi(X):null,re=null!=X&&X.length>0&&(isNaN(Number(X))||P.fi(X).lt(ee)),ne=je(ee,x.mul(T.eG),g),ae=!re&&te&&x&&g?je(te,x,g):null,se=x.toNumber()*T.eG*100/g.toNumber(),oe=null===te||void 0===te?void 0:te.mul(se).div(100),le=re||!X,ue=ae?ke(ae,T.er):null;function de(){return(de=(0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V(!0),O(!1),w){e.next=4;break}throw new Error("Could not find licenseDiamondContract");case 4:if(te){e.next=6;break}throw new Error("Could not find newForSalePrice");case 6:if(ae){e.next=8;break}throw new Error("Could not find newNetworkFee");case 8:return e.prev=8,e.next=11,w.placeBid(ae,te);case 11:return t=e.sent,e.next=14,t.wait();case 14:e.next=23;break;case 16:return e.prev=16,e.t0=e.catch(8),console.error(e.t0),z(e.t0.reason?e.t0.reason.replace("execution reverted: ",""):e.t0.message),O(!0),V(!1),e.abrupt("return");case 23:V(!1),L(!0),S(Wt.PARCEL_SELECTED);case 26:case"end":return e.stop()}}),e,null,[[8,16]])})))).apply(this,arguments)}return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(C.Z,{border:"secondary",className:"bg-dark mt-5",children:[(0,o.jsx)(C.Z.Header,{children:(0,o.jsx)("h3",{children:"Place Bid"})}),(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsxs)(N.Z,{children:[(0,o.jsxs)(N.Z.Group,{children:[(0,o.jsxs)(N.Z.Text,{className:"text-primary mb-1",children:["New For Sale Price (",T.RU,", Fully Collateralized)",(0,o.jsx)(D,{content:(0,o.jsxs)("div",{style:{textAlign:"left"},children:["The current licensor will have 7 days to respond to your bid. They must pay a 10% penalty if they reject your bid. If they do not act during this window, you must submit another transaction to take effective control of the parcel.",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),(0,o.jsx)("a",{href:"https://docs.geoweb.network/concepts/partial-common-ownership",target:"_blank",rel:"noopener",children:"You can read more about Partial Common Ownership in our docs."})]}),target:xt})]}),(0,o.jsx)(N.Z.Control,{required:!0,isInvalid:re,className:"bg-dark text-light mt-1",type:"text",placeholder:"New For Sale Price (".concat(T.RU,")"),"aria-label":"For Sale Price","aria-describedby":"for-sale-price",disabled:$,onChange:function(e){return K(e.target.value)}}),re?(0,o.jsx)(N.Z.Control.Feedback,{type:"invalid",children:"Must be equal or exceed the current For Sale Price"}):null,(0,o.jsx)("br",{}),(0,o.jsxs)(N.Z.Text,{className:"text-primary mb-1",children:[se,"% Network Fee (",T.RU,", Streamed)",(0,o.jsx)(D,{content:(0,o.jsxs)("div",{style:{textAlign:"left"},children:["Network fees are proportional to your For Sale Price. They discourage squatting & create a healthier market. They are used to fund public goods\u2014promoting positive-sum outcomes. You have a say in how they're spent!",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"You pay these fees by opening a per-second stream. Your total yearly payment will be slightly lower than the displayed value due to rounding."]}),target:xt})]}),(0,o.jsx)(N.Z.Control,{className:"bg-dark text-info mt-1",type:"text",readOnly:!0,disabled:!0,value:"".concat(oe?W(B(oe),10):"0"," ").concat(T.RU,"/year"),"aria-label":"Network Fee","aria-describedby":"network-fee"})]}),(0,o.jsx)("br",{}),(0,o.jsx)("hr",{className:"action-form_divider"}),(0,o.jsx)("br",{}),!re&&ne?(0,o.jsx)(Ie,(0,f.Z)({existingAnnualNetworkFee:ne,newAnnualNetworkFee:null!==oe&&void 0!==oe?oe:null,currentForSalePrice:ee,collateralDeposit:null!==te&&void 0!==te?te:void 0},e)):null,(0,o.jsx)("br",{}),(0,o.jsx)(l.Z,{variant:"secondary",className:"w-100 mb-3",onClick:function(){return G(!0)},children:"Wrap to ".concat(T.RU)}),(0,o.jsx)(ce,(0,h.Z)((0,f.Z)({},e),{isDisabled:$||le,buttonText:"Bid",requiredFlowAmount:null!==oe&&void 0!==oe?oe:null,requiredPayment:te&&ue?te.add(ue):null,performAction:function(){return de.apply(this,arguments)},spender:null!==(t=null===w||void 0===w?void 0:w.address)&&void 0!==t?t:null,requiredFlowPermissions:1,flowOperator:null!==(r=null===w||void 0===w?void 0:w.address)&&void 0!==r?r:null,setErrorMessage:z,setIsActing:V,setDidFail:O}))]}),(0,o.jsx)("br",{}),_&&!$?(0,o.jsx)(ie,{message:Y,onClick:function(){return O(!1)}}):null]}),(0,o.jsx)(C.Z.Footer,{className:"border-top border-secondary",children:(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(v.Z,{sm:"1",children:(0,o.jsx)(c.Z,{src:"notice.svg"})}),(0,o.jsx)(v.Z,{className:"fst-italic",children:"Claims, transfers, changes to For Sale Prices, and network fee payments require confirmation in your Web3 wallet."})]})})]}),R&&(0,o.jsx)(H,{account:j,provider:m,show:R,handleClose:function(){return G(!1)},paymentToken:b}),(0,o.jsx)(Pe,{account:j,ceramic:d,registryContract:p,paymentToken:b,disconnectWallet:y,provider:m,setSelectedParcelId:k,setInteractionState:S,setPortfolioNeedActionCount:Z,setPortfolioParcelCoords:I,isPortfolioToUpdate:F,setIsPortfolioToUpdate:L})]})};ge().extend(dt()),ge().extend(mt());var bt=(0,o.jsx)(c.Z,{style:{width:"1.1rem",marginLeft:"4px"},src:"info.svg"});var vt=function(e){var t=e.parcelData,r=e.ceramic,i=e.provider,d=e.perSecondFeeNumerator,p=e.perSecondFeeDenominator,m=e.paymentToken,x=e.disconnectWallet,g=e.account,b=e.licenseDiamondContract,y=e.registryContract,j=e.bidTimestamp,w=e.bidForSalePrice,k=e.setSelectedParcelId,S=e.setInteractionState,Z=e.setPortfolioNeedActionCount,I=e.setPortfolioParcelCoords,F=e.isPortfolioToUpdate,L=e.setIsPortfolioToUpdate,A=W(B(w),18),R=(0,a.Z)(u.useState(!1),2),G=R[0],M=R[1],_=(0,a.Z)(u.useState(!1),2),O=_[0],U=_[1],Y=(0,a.Z)(u.useState(""),2),z=Y[0],q=Y[1],$=(0,a.Z)(u.useState(!1),2),V=$[0],Q=$[1],X=(0,a.Z)(u.useState(A),2),K=X[0],J=X[1],ee=(0,o.jsx)("span",{className:"spinner-border",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Sending Transaction..."})}),te=B(t.currentBid.forSalePrice),re=P.fi(te),ne=K.length>0&&!isNaN(Number(K))?P.fi(K):null,ae=K.length>0&&(isNaN(Number(K))||P.fi(K).lt(w)),se=je(re,d,p),oe=je(re,d.mul(T.eG),p),le=!ae&&ne&&d&&p?je(ne,d,p):null,ue=d.toNumber()*T.eG*100/p.toNumber(),de=null===ne||void 0===ne?void 0:ne.mul(ue).div(100),pe=(0,a.Z)(u.useState(null),2),me=pe[0],fe=pe[1],he=(0,a.Z)(u.useState(null),2),xe=he[0],be=he[1],ve=(0,a.Z)(u.useState(null),2),ye=ve[0],we=ve[1],Se=xe&&ye?w.mul(xe).div(ye):null,Ze=ae||!K||!Se,Ce=ke(se,T.er),Ne=le?ke(le,T.er):null;u.useEffect((function(){function e(){return(e=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y){e.next=2;break}return e.abrupt("return");case 2:return e.t0=fe,e.next=5,y.getBidPeriodLengthInSeconds();case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y){e.next=2;break}return e.abrupt("return");case 2:return e.t0=be,e.next=5,y.getPenaltyNumerator();case 5:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=we,e.next=10,y.getPenaltyDenominator();case 10:e.t3=e.sent,(0,e.t2)(e.t3);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[y]);var Ee,Te,Fe=j&&me?j.add(me):null,Le=Fe?ge()(1e3*Fe.toNumber()).utc().format("YYYY-MM-DD HH:mm"):null;function Ae(){return(Ae=(0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Q(!0),U(!1),b){e.next=4;break}throw new Error("Could not find licenseDiamondContract");case 4:if(ne){e.next=6;break}throw new Error("Could not find newForSalePrice");case 6:if(le){e.next=8;break}throw new Error("Could not find newNetworkFee");case 8:if(Se){e.next=10;break}throw new Error("Could not find penaltyPayment");case 10:return e.prev=10,e.next=13,b.rejectBid();case 13:return t=e.sent,e.next=16,t.wait();case 16:e.next=25;break;case 18:return e.prev=18,e.t0=e.catch(10),console.error(e.t0),q(e.t0.reason?e.t0.reason.replace("execution reverted: ",""):e.t0.message),U(!0),Q(!1),e.abrupt("return");case 25:Q(!1),L(!0),S(Wt.PARCEL_SELECTED);case 28:case"end":return e.stop()}}),e,null,[[10,18]])})))).apply(this,arguments)}return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(C.Z,{border:"secondary",className:"bg-dark mt-5",children:[(0,o.jsx)(C.Z.Header,{children:(0,o.jsx)("h3",{children:"Reject Bid"})}),(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsxs)("p",{children:["For Sale Price (Bid): ",A," ",T.RU]}),(0,o.jsxs)("p",{children:["Response Deadline:"," ",Le||ee," UTC"]}),(0,o.jsxs)(N.Z,{children:[(0,o.jsxs)(N.Z.Group,{children:[(0,o.jsxs)(N.Z.Text,{className:"text-primary mb-1",children:["New For Sale Price (",T.RU,")",(0,o.jsx)(D,{content:(0,o.jsxs)("div",{style:{textAlign:"left"},children:["You\u2019re rejecting a bid that is higher than your previous For Sale Price, so make sure to set this as accurately as you can this time!",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"You'll have 7 days to accept or reject any new bid that meets this price. You must pay another penalty equal to 10% of the bidder's new For Sale Price if you wish to reject a subsequent bid.",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),(0,o.jsx)("a",{href:"https://docs.geoweb.network/concepts/partial-common-ownership",target:"_blank",rel:"noopener",children:"You can read more about Partial Common Ownership in our docs."})]}),target:bt})]}),(0,o.jsx)(N.Z.Control,{required:!0,isInvalid:ae,className:"bg-dark text-light mt-1",type:"text",placeholder:"New For Sale Price (".concat(T.RU,")"),defaultValue:A,"aria-label":"For Sale Price","aria-describedby":"for-sale-price",disabled:V,onChange:function(e){return J(e.target.value)}}),ae?(0,o.jsx)(N.Z.Control.Feedback,{type:"invalid",children:"Must be equal or exceed the bid For Sale Price"}):null,(0,o.jsx)("br",{}),(0,o.jsxs)(N.Z.Text,{className:"text-primary mb-1",children:[ue,"% Network Fee (",T.RU,", Streamed)",(0,o.jsx)(D,{content:(0,o.jsxs)("div",{style:{textAlign:"left"},children:["Network fees are proportional to your For Sale Price. They discourage squatting & create a healthier market. They are used to fund public goods\u2014promoting positive-sum outcomes. You have a say in how they're spent!",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"You pay these fees by opening a per-second stream. Your total yearly payment will be slightly lower than the displayed value due to rounding."]}),target:bt})]}),(0,o.jsx)(N.Z.Control,{className:"bg-dark text-info mt-1",type:"text",readOnly:!0,disabled:!0,value:"".concat(de?W(B(de),10):"0"," ").concat(T.RU,"/year"),"aria-label":"Network Fee","aria-describedby":"network-fee"})]}),(0,o.jsx)(ht,{}),(0,o.jsx)("br",{}),(0,o.jsx)("hr",{className:"action-form_divider"}),(0,o.jsx)("br",{}),!ae&&oe?(0,o.jsx)(Ie,(0,f.Z)({existingAnnualNetworkFee:oe,newAnnualNetworkFee:null!==de&&void 0!==de?de:null,currentForSalePrice:re,penaltyPayment:null!==Se&&void 0!==Se?Se:void 0},e)):null,(0,o.jsx)("br",{}),(0,o.jsx)(l.Z,{variant:"secondary",className:"w-100 mb-3",onClick:function(){return M(!0)},children:"Wrap to ".concat(T.RU)}),(0,o.jsx)(ce,(0,h.Z)((0,f.Z)({},e),{isDisabled:V||Ze,buttonText:"Bid",requiredFlowAmount:null!==de&&void 0!==de?de:null,requiredPayment:Se&&Ne?Se.add(Ne).sub(Ce):null,performAction:function(){return Ae.apply(this,arguments)},spender:null!==(Ee=null===b||void 0===b?void 0:b.address)&&void 0!==Ee?Ee:null,requiredFlowPermissions:2,flowOperator:null!==(Te=null===b||void 0===b?void 0:b.address)&&void 0!==Te?Te:null,setErrorMessage:q,setIsActing:Q,setDidFail:U}))]}),(0,o.jsx)("br",{}),O&&!V?(0,o.jsx)(ie,{message:z,onClick:function(){return U(!1)}}):null]}),(0,o.jsx)(C.Z.Footer,{className:"border-top border-secondary",children:(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(v.Z,{sm:"1",children:(0,o.jsx)(c.Z,{src:"notice.svg"})}),(0,o.jsx)(v.Z,{className:"fst-italic",children:"Claims, transfers, changes to For Sale Prices, and network fee payments require confirmation in your Web3 wallet."})]})})]}),G&&(0,o.jsx)(H,{account:g,provider:i,show:G,handleClose:function(){return M(!1)},paymentToken:m}),(0,o.jsx)(Pe,{account:g,ceramic:r,registryContract:y,paymentToken:m,disconnectWallet:x,provider:i,setSelectedParcelId:k,setInteractionState:S,setPortfolioNeedActionCount:Z,setPortfolioParcelCoords:I,isPortfolioToUpdate:F,setIsPortfolioToUpdate:L})]})};var yt=function(e){var t=e.account,r=e.licenseOwner,n=e.forSalePrice,a=e.auctionStart,i=e.interactionState,s=e.setInteractionState,c=e.requiredBid,d=e.setRequiredBid,p=(0,u.useState)(""),m=p[0],f=p[1],h=(0,u.useState)(null),x=h[0],g=h[1],b=(0,u.useMemo)((function(){return c?W(B(c),8):null}),[c]);(0,u.useEffect)((function(){var e=null;if(n&&a){var t=1e3*(a.toNumber()+T.oq);f("".concat(ge()(t).utc().format("MM/DD/YYYY HH:mm")," UTC")),e=setInterval((function(){var e=t-Date.now();g(we(e)),d(Se(n,a,T.oq))}),1e3)}return function(){e&&clearInterval(e)}}),[n,a]);var v=null==n||null==a||null==x,y=(0,o.jsx)("span",{className:"spinner-border",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),j=(0,o.jsx)(l.Z,{variant:"primary",className:"w-100",onClick:function(){s(Wt.PARCEL_RECLAIMING)},children:t.toLowerCase()==(null===r||void 0===r?void 0:r.toLowerCase())?"Reclaim":"Claim"});return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(C.Z,{className:"bg-purple bg-opacity-25",children:[(0,o.jsx)(C.Z.Header,{children:(0,o.jsx)("h4",{children:i==Wt.PARCEL_RECLAIMING?"Dutch Auction Details":"Foreclosure Dutch Auction"})}),(0,o.jsxs)(C.Z.Body,{className:"pb-4",children:[(0,o.jsxs)("p",{className:"text-truncate",children:[(0,o.jsx)("span",{className:"font-weight-bold",children:"Current Required Bid: "}),v?y:"".concat(b," ").concat(T.RU)]}),(0,o.jsxs)("p",{className:"text-truncate",children:[(0,o.jsx)("span",{className:"font-weight-bold",children:"Auction End:"})," ",v?y:m]}),(0,o.jsxs)("p",{className:"text-truncate",children:[(0,o.jsx)("span",{className:"font-weight-bold",children:"Time Remaining:"})," ",v?y:x]}),i==Wt.PARCEL_RECLAIMING?null:j]})]})})};function jt(){var e=(0,x.Z)(["\n  query GeoWebParcel($id: String) {\n    geoWebParcel(id: $id) {\n      id\n      licenseOwner\n      licenseDiamond\n      currentBid {\n        contributionRate\n        perSecondFeeNumerator\n        perSecondFeeDenominator\n        forSalePrice\n        timestamp\n      }\n      pendingBid {\n        timestamp\n        bidder\n        contributionRate\n        perSecondFeeNumerator\n        perSecondFeeDenominator\n        forSalePrice\n      }\n    }\n  }\n"]);return jt=function(){return e},e}var wt=(0,g.Ps)(jt());var kt=function(e){var t,r,i,d,p,m,x,g,y=e.account,j=e.interactionState,w=e.setInteractionState,k=e.selectedParcelId,S=e.setIsParcelAvailable,Z=e.ceramic,C=e.registryContract,N=e.ipfs,P=e.firebasePerf,F=e.invalidLicenseId,D=e.setInvalidLicenseId,W=e.provider,M=e.selectedParcelCoords,_=(0,b.a)(wt,{variables:{id:k},pollInterval:2e3}),O=_.loading,U=_.data,Y=(0,a.Z)(u.useState(null),2),z=Y[0],q=Y[1],H=(0,a.Z)(u.useState(null),2),$=H[0],V=H[1],Q=(0,a.Z)(u.useState(null),2),X=Q[0],K=Q[1],ae=(0,a.Z)(u.useState(null),2),ie=ae[0],se=ae[1],oe=function(e){var t=(0,a.Z)(u.useState(null),2),r=t[0],i=t[1];return u.useEffect((function(){(0,n.Z)(s().mark((function t(){var r,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return i(null),t.abrupt("return");case 3:return i(null),r=new J(e),t.next=7,e.getRecordID("basicProfile");case 7:return n=t.sent,console.debug("Setting up basicProfile: ".concat(n)),t.next=11,r.setExistingStreamId(n);case 11:console.debug("Setup basicProfile complete."),i(r);case 13:case"end":return t.stop()}}),t)})))()}),[e]),r}($),ce=function(e,t,r){var i=(0,a.Z)(u.useState(null),2),o=i[0],c=i[1];return u.useEffect((function(){function a(){return(a=(0,n.Z)(s().mark((function n(){var a,i,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e&&t&&r){n.next=3;break}return c(null),n.abrupt("return");case 3:return console.debug("Setting up pinning manager..."),a=new Ue(e,t),n.next=7,e.getRecordID("geoWebPinset");case 7:return i=n.sent,console.debug("Setting up geoWebPinset: ".concat(i)),n.next=11,a.setExistingStreamId(i);case 11:return console.debug("Setup geoWebPinset complete."),o=new qe(a,t,r),n.next=15,a.fetchOrProvisionBucket();case 15:c(o),console.debug("Pinning manager setup complete");case 17:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){a.apply(this,arguments)}()}),[e,t,r]),o}($,N,P),le=oe?oe.getStreamContent():null,ue=(0,o.jsx)("span",{className:"spinner-border",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),de=U&&U.geoWebParcel?(0,o.jsxs)(o.Fragment,{children:[B(U.geoWebParcel.currentBid.forSalePrice)," ",T.RU," "]}):null,pe=null===U||void 0===U||null===(t=U.geoWebParcel)||void 0===t?void 0:t.licenseOwner,me=!!(U&&U.geoWebParcel&&U.geoWebParcel.pendingBid)&&(null!==(x=I.O$.from(U.geoWebParcel.pendingBid.contributionRate).gt(I.O$.from(0)))&&void 0!==x&&x),fe=me&&null!==(g=null===U||void 0===U||null===(r=U.geoWebParcel)||void 0===r||null===(i=r.pendingBid)||void 0===i?void 0:i.bidder)&&void 0!==g?g:null,he=U&&U.geoWebParcel?I.O$.from(U.geoWebParcel.currentBid.forSalePrice):null,xe=U&&U.geoWebParcel?I.O$.from(U.geoWebParcel.currentBid.timestamp):null,ge=I.O$.from(me?null===U||void 0===U||null===(d=U.geoWebParcel)||void 0===d||null===(p=d.pendingBid)||void 0===p?void 0:p.forSalePrice:0),be=me&&U&&U.geoWebParcel&&U.geoWebParcel.pendingBid?I.O$.from(U.geoWebParcel.pendingBid.timestamp):null,ye=null===U||void 0===U||null===(m=U.geoWebParcel)||void 0===m?void 0:m.licenseDiamond;u.useEffect((function(){var e=function(){var e=(0,n.Z)(s().mark((function e(){var t,r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ye){e.next=3;break}return se(null),e.abrupt("return");case 3:return t=W.getSigner(),r=ve.PCOLicenseDiamondFactory.connect(ye,t),se(r),e.next=8,r.isPayerBidActive();case 8:n=e.sent,D(n?"":k);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[ye]),u.useEffect((function(){(0,n.Z)(s().mark((function e(){var t,r,n,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=Z&&Z.did){e.next=3;break}return console.error("Ceramic instance not found"),e.abrupt("return");case 3:if(V(null),!k||!pe){e.next=16;break}return t=new ee.xW({chainId:"eip155:".concat(T.er),assetName:{namespace:"erc721",reference:C.address.toLowerCase()},tokenId:new(L())(k.slice(2),"hex").toString(10)}),r=new ee.hX({chainId:"eip155:".concat(T.er),address:pe}),n=new re.v({ceramic:Z,aliases:te.model}),a=new ne(Z,n,"did:pkh:".concat(r.toString()),t),V(a),e.next=12,a.getIndex();case 12:i=e.sent,q(i.id.toString()),e.next=17;break;case 16:V(null),q(null);case 17:case"end":return e.stop()}}),e)})))()}),[Z,k,pe,C]),(0,u.useEffect)((function(){S(!fe||!(me&&fe!==y))}),[U]);var je,we=O||null==U;if(le&&le.url&&le.url.startsWith("ipfs://")){var ke=new(Le())(le.url.split("ipfs://")[1]);je="ipfs://".concat(ke.toV1().toBaseEncodedString("base32"))}else le&&(je=le.url);var Se,Ze,Ce=(0,o.jsx)(l.Z,{variant:"danger",className:"w-100",onClick:function(){w(Wt.PARCEL_SELECTED)},children:"Cancel"}),Ne=(0,o.jsx)(l.Z,{variant:"primary",className:"w-100 mb-2",onClick:function(){w(Wt.PARCEL_EDITING)},children:"Edit Parcel"}),Pe=(0,o.jsx)(l.Z,{variant:"secondary",className:"w-100",onClick:function(){w(Wt.EDITING_GALLERY)},children:"Edit Media Gallery"}),Ie=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.Z,{variant:"primary",className:"w-100",onClick:function(){w(Wt.PARCEL_PLACING_BID)},children:"Place Bid"}),(0,o.jsx)(ht,{})]});if(j==Wt.CLAIM_SELECTING||j==Wt.CLAIM_SELECTED)Se=(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(E.Z,{className:"mb-3",children:[(0,o.jsx)(v.Z,{sm:"10",children:(0,o.jsx)("h1",{style:{fontSize:"1.5rem",fontWeight:600},children:"Claim a Parcel"})}),(0,o.jsx)(v.Z,{sm:"2",children:(0,o.jsx)("div",{className:"text-end",children:(0,o.jsx)(l.Z,{variant:"link",size:"sm",onClick:function(){return w(Wt.VIEWING)},children:(0,o.jsx)(c.Z,{src:"close.svg"})})})})]})});else{var Ee,Te,Fe="".concat(T.uw,"?longitude=").concat(null===M||void 0===M?void 0:M.x,"&latitude=").concat(null===M||void 0===M?void 0:M.y);Se=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"bg-image mb-4",style:{backgroundImage:"url(Contour_Lines.png)"},children:[(0,o.jsx)("div",{className:"text-end",children:(0,o.jsx)(l.Z,{variant:"link",size:"sm",onClick:function(){return w(Wt.VIEWING)},children:(0,o.jsx)(c.Z,{src:"close.svg"})})}),(0,o.jsx)(E.Z,{children:(0,o.jsx)(v.Z,{className:"mx-3",sm:"10",children:(0,o.jsx)("h1",{style:{fontSize:"1.5rem",fontWeight:600},children:oe?le?le.name:(null===U||void 0===U||null===(Ee=U.geoWebParcel)||void 0===Ee?void 0:Ee.id)?"Parcel ".concat(null===U||void 0===U||null===(Te=U.geoWebParcel)||void 0===Te?void 0:Te.id):ue:ue})})}),(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(v.Z,{className:"mx-3",children:(0,o.jsx)("p",{className:"fw-bold text-truncate",children:le&&je?(0,o.jsx)("a",{href:je,target:"_blank",rel:"noreferrer",className:"text-light",children:"".concat(je)}):null})}),(0,o.jsx)(v.Z,{className:"text-end pt-2 mx-2",children:(0,o.jsx)(A.Z,{placement:"top",overlay:(0,o.jsx)(R.Z,{id:"tooltip-key",children:"Open in Spatial Browser"}),children:(0,o.jsx)(l.Z,{variant:"link",size:"sm",className:"text-right",href:Fe,target:"_blank",children:(0,o.jsx)(c.Z,{src:"open-in-browser.svg"})})},"top")})]})]}),j==Wt.PARCEL_RECLAIMING?(0,o.jsx)(E.Z,{className:"mb-3",children:(0,o.jsx)("h1",{style:{fontSize:"1.rem",fontWeight:600},children:y.toLowerCase()==(null===pe||void 0===pe?void 0:pe.toLowerCase())?"Reclaim":"Foreclosure Claim"})}):null]})}return j!=Wt.PARCEL_SELECTED?Ze=Ce:we||(y.toLowerCase()==(null===pe||void 0===pe?void 0:pe.toLowerCase())?Ze=(0,o.jsxs)(o.Fragment,{children:[Ne,Pe]}):me||(Ze=Ie)),(0,o.jsxs)(o.Fragment,{children:[Se,(0,o.jsx)(E.Z,{className:"pb-5",children:(0,o.jsxs)(v.Z,{children:[j==Wt.PARCEL_SELECTED||j==Wt.PARCEL_EDITING||j==Wt.PARCEL_PLACING_BID||j==Wt.PARCEL_REJECTING_BID||j==Wt.EDITING_GALLERY?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("span",{className:"fw-bold",children:"For Sale Price:"})," ",we?ue:de]}),(0,o.jsxs)("p",{className:"text-truncate",children:[(0,o.jsx)("span",{className:"fw-bold",children:"Parcel ID:"})," ",we?ue:k]}),(0,o.jsxs)("p",{className:"text-truncate",children:[(0,o.jsx)("span",{className:"fw-bold",children:"Licensee:"})," ",we||!pe?ue:G(pe,11)]}),(0,o.jsxs)("p",{className:"text-truncate",children:[(0,o.jsx)("span",{className:"fw-bold",children:"Stream ID:"})," ",null==z?ue:(0,o.jsx)("a",{href:"".concat(T.a2,"/").concat(z),target:"_blank",rel:"noreferrer",className:"text-light",children:"ceramic://".concat(z)})]}),(0,o.jsx)("br",{}),F==k?null:Ze]}):j==Wt.PARCEL_RECLAIMING?null:(0,o.jsx)("p",{children:"Unclaimed Coordinates"}),(j==Wt.PARCEL_RECLAIMING||j==Wt.PARCEL_SELECTED&&F==k&&U)&&pe&&he&&xe?(0,o.jsx)(yt,{account:y,licenseOwner:pe,forSalePrice:he,auctionStart:xe,interactionState:j,setInteractionState:w,requiredBid:X,setRequiredBid:K}):null,j==Wt.PARCEL_SELECTED&&me&&ge&&he?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ft,(0,f.Z)({newForSalePrice:ge,existingForSalePrice:he,bidTimestamp:null!==be&&void 0!==be?be:null,licensorIsOwner:pe===y,licenseDiamondContract:ie},e)),(0,o.jsx)(ht,{})]}):null,j==Wt.PARCEL_EDITING&&(null===U||void 0===U?void 0:U.geoWebParcel)?(0,o.jsx)(Ae,(0,f.Z)({basicProfileStreamManager:oe,parcelData:U.geoWebParcel,hasOutstandingBid:me,licenseDiamondContract:ie},e)):null,j==Wt.PARCEL_PLACING_BID&&(null===U||void 0===U?void 0:U.geoWebParcel)?(0,o.jsx)(gt,(0,f.Z)({parcelData:U.geoWebParcel,licenseDiamondContract:ie},e)):null,j==Wt.PARCEL_REJECTING_BID&&me&&ge&&(null===U||void 0===U?void 0:U.geoWebParcel)?(0,o.jsx)(vt,(0,f.Z)({parcelData:U.geoWebParcel,bidForSalePrice:ge,bidTimestamp:null!==be&&void 0!==be?be:null,licenseDiamondContract:ie},e)):null,j==Wt.PARCEL_RECLAIMING&&pe?(0,o.jsx)(Re,(0,h.Z)((0,f.Z)({},e),{licenseOwner:pe,licenseDiamondContract:ie,requiredBid:null!==X&&void 0!==X?X:void 0})):null]})}),(0,o.jsx)(lt,(0,f.Z)({pinningManager:ce,assetContentManager:$,show:j==Wt.EDITING_GALLERY},e))]})},St=r(1646),Zt=r.n(St);ge().extend(dt()),ge().extend(mt()),ge().extend(Zt());var Ct=(0,o.jsx)(c.Z,{style:{width:"1.1rem",marginLeft:"4px"},src:"info.svg"});var Nt=function(e){var t=e.auctionStart,r=e.auctionEnd,n=e.startingBid,a=e.endingBid,i=e.requiredBid,s=e.setRequiredBid,d=e.setInteractionState,p=(0,u.useState)(null),m=p[0],f=p[1],h=ge()(1e3*r.toNumber()).utc().format("YYYY-MM-DD HH:mm");return(0,u.useEffect)((function(){var e=null;return t&&r&&n&&a&&(e=setInterval((function(){var e=1e3*r.toNumber()-Date.now();f(we(e)),s(function(e,t,r,n){var a=I.O$.from(Math.floor(Date.now()/1e3));if(a.gt(t))return n;var i=a.sub(e),s=t.sub(e),o=r.mul(i).div(s);return r.sub(o)}(t,r,n,a))}),1e3)),function(){e&&clearInterval(e)}}),[t,r,n,a]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(E.Z,{className:"mb-3",children:[(0,o.jsx)(v.Z,{sm:"10",children:(0,o.jsx)("h1",{style:{fontSize:"1.5rem",fontWeight:600},children:"Fair Launch Claim"})}),(0,o.jsx)(v.Z,{sm:"2",className:"text-end",children:(0,o.jsx)(l.Z,{variant:"link",size:"sm",onClick:function(){return d(Wt.VIEWING)},children:(0,o.jsx)(c.Z,{src:"close.svg"})})})]}),(0,o.jsx)(C.Z,{border:"secondary",className:"bg-dark my-5",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsxs)(C.Z.Title,{className:"text-primary fw-bold d-flex justify-content-between ",children:[(0,o.jsx)("span",{children:"Dutch Auction Details"}),(0,o.jsx)(D,{content:(0,o.jsxs)("div",{style:{textAlign:"left"},children:["To promote a fair launch and help limit gas fee costs, Geo Web land claims were initiated with a global Dutch auction. The auction requires one-time payments (bids) to execute valid parcel claims. These auction payments are made in addition to the ongoing partial common ownership market requirements.",(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),"The auction started at [Auction Starting Price] ETHx and will linearly decrease in price over two weeks to an ongoing claim price of 0 ETHx."]}),target:Ct})]}),(0,o.jsxs)(C.Z.Text,{children:["Current Required Bid:"," ",W(P.dF(i),8)," ETHx"]}),(0,o.jsxs)(C.Z.Text,{children:["Auction End: ",h," UTC"]}),(0,o.jsxs)(C.Z.Text,{children:["Time Remaining: ",(0,o.jsx)("span",{children:m})]})]})})]})};var Pt=function(e){var t=e.registryContract,r=e.interactionState,i=e.setInteractionState,c=e.parcelClaimSize,l=e.selectedParcelCoords,d=(0,a.Z)(u.useState(null),2),p=d[0],m=d[1],x=(0,a.Z)(u.useState(null),2),g=x[0],b=x[1];u.useEffect((function(){t.getPerSecondFeeNumerator().then((function(e){m(e)})),t.getPerSecondFeeDenominator().then((function(e){b(e)}))}),[t]);var y=(0,a.Z)(u.useState(null),2),j=y[0],w=y[1],k=(0,a.Z)(u.useState(null),2),S=k[0],Z=k[1],C=(0,a.Z)(u.useState(null),2),N=C[0],P=C[1],E=(0,a.Z)(u.useState(null),2),T=E[0],F=E[1],L=(0,a.Z)(u.useState(I.O$.from(0)),2),A=L[0],R=L[1];u.useEffect((function(){var e=!0;return(0,n.Z)(s().mark((function r(){var n,i,o,c,l;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=a.Z,r.next=3,Promise.all([t.getStartingBid(),t.getEndingBid(),t.getAuctionStart(),t.getAuctionEnd()]);case 3:if(r.t1=r.sent,n=(0,r.t0)(r.t1,4),i=n[0],o=n[1],c=n[2],l=n[3],!c.isZero()&&!l.isZero()){r.next=11;break}return r.abrupt("return");case 11:e&&(w(i),Z(o),P(c),F(l));case 12:case"end":return r.stop()}}),r)})))(),function(){e=!1}}),[t]);var D=N&&T&&j&&S&&Date.now()/1e3<T.toNumber();return(0,o.jsxs)(v.Z,{sm:"3",className:"bg-dark px-4 text-light",style:{paddingTop:"120px",overflowY:"scroll",height:"100vh"},children:[D&&r==Wt.CLAIM_SELECTED?(0,o.jsx)(Nt,(0,f.Z)({auctionStart:N,auctionEnd:T,startingBid:j,endingBid:S,requiredBid:A,setRequiredBid:R},e)):p&&g?(0,o.jsx)(kt,(0,h.Z)((0,f.Z)({},e),{perSecondFeeNumerator:p,perSecondFeeDenominator:g,selectedParcelCoords:l})):null,r==Wt.CLAIM_SELECTING?(0,o.jsx)(Te,{setInteractionState:i,parcelClaimSize:c}):null,r==Wt.CLAIM_SELECTED&&p&&g?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Ee,(0,h.Z)((0,f.Z)({},e),{licenseAddress:t.address,isFairLaunch:null!==D&&void 0!==D?D:void 0,perSecondFeeNumerator:p,perSecondFeeDenominator:g,requiredBid:A}))}):null]})},It={id:"grid-layer",type:"fill",paint:{"fill-color":"#FFFFFF","fill-outline-color":"#000000","fill-opacity":.2}};var Et={id:"parcels-layer",type:"fill",paint:{"fill-color":"#2FC1C1","fill-opacity":.5}};function Tt(e,t){return{id:"parcels-highlight-layer",type:"fill",paint:{"fill-color":"#2FC1C1","fill-opacity":.75},filter:["any",["==","parcelId",e],["==","parcelId",t]]}}function Ft(e){return{id:"parcels-invalid-layer",type:"fill",paint:{"fill-color":"#E11515","fill-opacity":.75},filter:["==","parcelId",e]}}var Lt=function(e){var t,r=e.existingCoords,n=e.claimBase1Coord,a=e.claimBase2Coord,i=e.isValidClaim,s=e.setIsValidClaim,c=e.parcelClaimSize,l=e.setParcelClaimSize,d=null,p=(0,u.useMemo)((function(){var e=[];if(null!=n&&null!=a)for(var t=Math.min(n.x,a.x);t<=Math.max(n.x,a.x);t++)for(var r=Math.min(n.y,a.y);r<=Math.max(n.y,a.y);r++)d=me.BN.fromXandY(t,r,_t,Bt),e.push(Yt(d));return e}),[n,a]);return(0,u.useEffect)((function(){var e=!0;(d&&r.has(d.toString())||c>T.YE)&&(e=!1),s(e),l(p.length)}),[r,s,l,p]),(0,o.jsx)(y.Hw,{id:"claim-data",type:"geojson",data:{type:"FeatureCollection",features:p},children:(0,o.jsx)(y.mh,(0,f.Z)({},(t=i,{id:"claim-layer",type:"fill",source:"grid-layer",paint:{"fill-color":t?"#FAFF00":"#E11515","fill-opacity":.75}})))})};var At=function(e){var t=e.isGridVisible,r=e.grid,n=[];return null!=r&&t&&(n=r.features),(0,o.jsx)(o.Fragment,{children:null!=r?(0,o.jsx)(y.Hw,{id:"grid-data",type:"geojson",data:{type:"FeatureCollection",features:n},children:(0,o.jsx)(y.mh,(0,f.Z)({},It))}):null})};var Rt=function(e){var t=e.data,r=e.parcelHoverId,n=e.selectedParcelId,a=e.invalidLicenseId,i=(0,u.useMemo)((function(){var e=[];return null!==t&&(e=function(e){return e.geoWebCoordinates.map((function(e){return{type:"Feature",geometry:{type:"Polygon",coordinates:[[[e.pointBL.lon,e.pointBL.lat],[e.pointBR.lon,e.pointBR.lat],[e.pointTR.lon,e.pointTR.lat],[e.pointTL.lon,e.pointTL.lat]]]},properties:{parcelId:e.parcel.id}}}))}(t)),e}),[t]);return(0,o.jsxs)(y.Hw,{id:"parcel-data",type:"geojson",data:{type:"FeatureCollection",features:i},children:[(0,o.jsx)(y.mh,(0,f.Z)({},Et)),(0,o.jsx)(y.mh,(0,f.Z)({},Tt(r,n))),a==n&&(0,o.jsx)(y.mh,(0,f.Z)({},Ft(n)))]})},Dt=r(2086);r(48337),r(81634);function Gt(){var e=(0,x.Z)(["\n  query Polygons(\n    $lastBlock: BigInt\n    $minX: BigInt\n    $maxX: BigInt\n    $minY: BigInt\n    $maxY: BigInt\n  ) {\n    geoWebCoordinates(\n      orderBy: createdAtBlock\n      first: 1000\n      where: {\n        createdAtBlock_gt: $lastBlock\n        coordX_gte: $minX\n        coordX_lt: $maxX\n        coordY_gte: $minY\n        coordY_lt: $maxY\n      }\n    ) {\n      id\n      createdAtBlock\n      parcel {\n        id\n      }\n      pointBR {\n        lon\n        lat\n      }\n      pointBL {\n        lon\n        lat\n      }\n      pointTR {\n        lon\n        lat\n      }\n      pointTL {\n        lon\n        lat\n      }\n    }\n  }\n"]);return Gt=function(){return e},e}var Wt,Mt=50,Bt=21,_t=22,Ot=1e3;!function(e){e[e.VIEWING=0]="VIEWING",e[e.CLAIM_SELECTING=1]="CLAIM_SELECTING",e[e.CLAIM_SELECTED=2]="CLAIM_SELECTED",e[e.PARCEL_SELECTED=3]="PARCEL_SELECTED",e[e.PARCEL_EDITING=4]="PARCEL_EDITING",e[e.PARCEL_PLACING_BID=5]="PARCEL_PLACING_BID",e[e.EDITING_GALLERY=6]="EDITING_GALLERY",e[e.PARCEL_REJECTING_BID=7]="PARCEL_REJECTING_BID",e[e.PARCEL_RECLAIMING=8]="PARCEL_RECLAIMING"}(Wt||(Wt={}));var Ut=(0,g.Ps)(Gt());function Yt(e){return{type:"Feature",geometry:{type:"Polygon",coordinates:[e.toGPS()]},properties:{gwCoord:parseInt(e.toString()).toString(16),gwCoordX:e.getX().toNumber(),gwCoordY:e.getY().toNumber()}}}function zt(e,t){return{minX:Math.floor((e-Ot)/Ot)*Ot,maxX:Math.floor((e+Ot)/Ot)*Ot,minY:Math.floor((t-Ot)/Ot)*Ot,maxY:Math.floor((t+Ot)/Ot)*Ot}}var qt,Ht,$t="storedMapStyleName";!function(e){e.satellite="satellite",e.street="street"}(qt||(qt={}));var Vt=(Ht={},(0,m.Z)(Ht,qt.satellite,"mapbox://styles/mapbox/satellite-streets-v11"),(0,m.Z)(Ht,qt.street,"mapbox://styles/codynhat/ckrwf327s69zk17mrdkej5fln"),Ht);var Qt=function(e){var t=function(){if(null!=x&&null!=I){var e;if(x.geoWebCoordinates.length>0)e=x.geoWebCoordinates[x.geoWebCoordinates.length-1].createdAtBlock;else{if(!je.id)return;e=0}var t=me.BN.fromGPS(I.longitude,I.latitude,_t,Bt),r=zt(t.getX().toNumber(),t.getY().toNumber());g({variables:(0,f.Z)({lastBlock:e},r)})}},r=function(e){if(s!=Wt.EDITING_GALLERY){E(e),(s==Wt.CLAIM_SELECTING||s==Wt.CLAIM_SELECTED)&&e.zoom>=17&&function(e,t,r,n){var a=me.BN.fromGPS(t,e,_t,Bt),i=a.getX().toNumber(),s=a.getY().toNumber();if(!(null!=r&&Math.abs(r.center.x-i)<25&&Math.abs(r.center.y-s)<25)){for(var o=[],c=i-Mt;c<i+Mt;c++)for(var l=s-Mt;l<s+Mt;l++)o.push(Yt(me.BN.fromXandY(c,l,_t,Bt)));n({center:{x:i,y:s},features:o})}}(I.latitude,I.longitude,_,O);var t=me.BN.fromGPS(e.longitude,e.latitude,_t,Bt),r=t.getX().toNumber(),n=t.getY().toNumber(),a=zt(r,n);if(e.zoom>=8&&F){var i=(0,f.Z)({lastBlock:0},a);j(i),L(!1)}if(e.zoom<8&&L(!0),e.zoom>=8&&(Math.abs(r-R)>Ot||Math.abs(n-W)>Ot)){var o=(0,f.Z)({lastBlock:0},a);j(o),D(r),M(n)}}},n=e.selectedParcelId,i=e.setSelectedParcelId,s=e.interactionState,d=e.setInteractionState,p=e.portfolioParcelCoords,m=(0,b.a)(Ut,{variables:{lastBlock:0,minX:0,maxX:0,minY:0,maxY:0}}),x=m.data,g=m.fetchMore,j=m.refetch,w=(0,u.useRef)(),k=(0,a.Z)(u.useState(localStorage.getItem($t)||qt.satellite),2),S=k[0],C=k[1],N=function(e){localStorage.setItem($t,e),C(e)},P=(0,u.useState)({latitude:40.780503,longitude:-73.96663,zoom:13,bearing:0,pitch:0,padding:{top:0,bottom:0,left:0,right:0}}),I=P[0],E=P[1],T=(0,u.useState)(!0),F=T[0],L=T[1],A=(0,u.useState)(0),R=A[0],D=A[1],G=(0,u.useState)(0),W=G[0],M=G[1],B=(0,u.useState)(null),_=B[0],O=B[1],U=(0,u.useState)(""),Y=U[0],z=U[1],q=(0,u.useState)(null),H=q[0],$=q[1],V=(0,u.useState)(null),Q=V[0],X=V[1],K=(0,u.useState)(null),J=K[0],ee=K[1],te=(0,u.useState)(new Set),re=te[0],ne=te[1],ae=(0,a.Z)(u.useState(!0),2),ie=ae[0],se=ae[1],oe=(0,a.Z)(u.useState(!0),2),ce=oe[0],le=oe[1],ue=(0,a.Z)(u.useState(0),2),de=ue[0],pe=ue[1],fe=(0,a.Z)(u.useState(["parcels-layer"]),2),he=fe[0],xe=fe[1],ge=(0,u.useState)(""),be=ge[0],ve=ge[1],ye=(0,a.Z)(u.useState({id:"",timerId:null}),2),je=ye[0],we=ye[1],ke=I.zoom>=17&&(s==Wt.CLAIM_SELECTING||s==Wt.CLAIM_SELECTED);(0,u.useEffect)((function(){if(je.id){var e,r,n,a=null===(r=null===x||void 0===x?void 0:x.geoWebCoordinates[(null===(e=x.geoWebCoordinates)||void 0===e?void 0:e.length)-1])||void 0===r?void 0:r.parcel;if((null===a||void 0===a?void 0:a.id)===je.id)return clearInterval(null!==(n=je.timerId)&&void 0!==n?n:void 0),void we({id:"",timerId:null});je.timerId||we((0,h.Z)((0,f.Z)({},je),{timerId:Number(setInterval(t,2e3))}))}return t(),function(){je.timerId&&clearInterval(je.timerId)}}),[x,je.id,g]);var Se,Ze=(0,u.useCallback)((function(e){var t,r=e.longitude,n=e.latitude,a=e.duration,i=e.zoom;null===(t=w.current)||void 0===t||t.flyTo({center:[r,n],duration:a,zoom:i})}),[]);return(0,u.useEffect)((function(){switch(s){case Wt.VIEWING:$(null),X(null),i(""),z(""),xe(["parcels-layer"]);break;case Wt.PARCEL_SELECTED:$(null),X(null),z(n);break;case Wt.CLAIM_SELECTING:xe(["parcels-layer","grid-layer"])}}),[s]),(0,u.useEffect)((function(){if(null!=x){var e=new Set(x.geoWebCoordinates.flatMap((function(e){return e.id})));ne(e)}var t=function(e){"Escape"===e.key&&(d(Wt.VIEWING),xe(["parcels-layer"]))};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}),[x]),(0,u.useEffect)((function(){p&&Ze({longitude:p.lon,latitude:p.lat,zoom:18,duration:500})}),[p]),(0,o.jsxs)(o.Fragment,{children:[s!=Wt.VIEWING?(0,o.jsx)(Pt,(0,h.Z)((0,f.Z)({},e),{interactionState:s,setInteractionState:d,claimBase1Coord:H,claimBase2Coord:Q,selectedParcelId:n,setSelectedParcelId:i,setIsParcelAvailable:le,parcelClaimSize:de,invalidLicenseId:be,setInvalidLicenseId:ve,setNewParcel:we,selectedParcelCoords:J})):null,(0,o.jsx)(v.Z,{sm:s!=Wt.VIEWING?"9":"12",className:"px-0",children:(0,o.jsxs)(y.ZP,(0,h.Z)((0,f.Z)({style:{width:s!=Wt.VIEWING?"75vw":"100vw",height:(Wt.VIEWING,"100vh")},ref:w},I),{mapboxAccessToken:"pk.eyJ1IjoidG5yZGQiLCJhIjoiY2w1Y2Y1ajk2MDBjbzNmbXB4bzZkcDN1YyJ9.wSkr6mgcjIZVyAVL4Z1tTA",mapStyle:Vt[S],interactiveLayerIds:he,projection:"globe",fog:{},onLoad:function(){var e=me.BN.fromGPS(I.longitude,I.latitude,_t,Bt),t=e.getX().toNumber(),r=e.getY().toNumber(),n=zt(t,r),a=(0,f.Z)({lastBlock:0},n);j(a),D(t),M(r)},onMove:function(e){return r(e.viewState)},onMouseMove:function(e){if(!(null==e.features||I.zoom<5)){var t=e.features.find((function(e){return"grid-layer"===e.layer.id}));switch(s){case Wt.VIEWING:a();break;case Wt.CLAIM_SELECTING:var r,n;if(t)X({x:null===(r=t.properties)||void 0===r?void 0:r.gwCoordX,y:null===(n=t.properties)||void 0===n?void 0:n.gwCoordY});break;case Wt.PARCEL_SELECTED:a()}}function a(){var t,r=null===(t=e.features)||void 0===t?void 0:t.find((function(e){return"parcels-layer"===e.layer.id}));if(r){var n;z(null===(n=r.properties)||void 0===n?void 0:n.parcelId)}else{var a=me.BN.fromGPS(e.lngLat.lng,e.lngLat.lat,_t,Bt);re.has(a.toString())||z("")}}},onClick:function(e){var t;if(!(I.zoom<5)){var r=null===(t=e.features)||void 0===t?void 0:t.find((function(e){return"grid-layer"===e.layer.id})),n=me.BN.fromGPS(e.lngLat.lng,e.lngLat.lat,_t,Bt),a={x:n.getX().toNumber(),y:n.getY().toNumber()};switch(s){case Wt.VIEWING:if(l())return;$(a),X(a),d(Wt.CLAIM_SELECTING),Ze({longitude:e.lngLat.lng,latitude:e.lngLat.lat,zoom:18,duration:500});break;case Wt.CLAIM_SELECTING:if(!ie)break;var o,c;if(r)X({x:null===(o=r.properties)||void 0===o?void 0:o.gwCoordX,y:null===(c=r.properties)||void 0===c?void 0:c.gwCoordY});d(Wt.CLAIM_SELECTED);break;case Wt.CLAIM_SELECTED:d(Wt.VIEWING);break;case Wt.PARCEL_SELECTED:if(l())return;d(Wt.VIEWING)}}function l(){var t,r,n=null===(t=e.features)||void 0===t?void 0:t.find((function(e){return"parcels-layer"===e.layer.id}));if(ee({x:e.lngLat.lng,y:e.lngLat.lat}),n)return i(null===(r=n.properties)||void 0===r?void 0:r.parcelId),d(Wt.PARCEL_SELECTED),!0;if(Y)return i(Y),d(Wt.PARCEL_SELECTED),!0;var a=me.BN.fromGPS(e.lngLat.lng,e.lngLat.lat,_t,Bt);return!!re.has(a.toString())}},children:[(0,o.jsx)(At,{grid:_,isGridVisible:ke}),(0,o.jsx)(Rt,{data:null!==x&&void 0!==x?x:null,isAvailable:ce,parcelHoverId:Y,selectedParcelId:n,invalidLicenseId:be}),(0,o.jsx)(Lt,{existingCoords:re,claimBase1Coord:H,claimBase2Coord:Q,isValidClaim:ie,setIsValidClaim:se,parcelClaimSize:de,setParcelClaimSize:pe}),(0,o.jsx)(Z,{mapboxAccessToken:null!==(Se="pk.eyJ1IjoidG5yZGQiLCJhIjoiY2w1Y2Y1ajk2MDBjbzNmbXB4bzZkcDN1YyJ9.wSkr6mgcjIZVyAVL4Z1tTA")?Se:"",position:"top-right"}),(0,o.jsx)(y.Pv,{position:"bottom-right"})]}))}),(0,o.jsxs)(Dt.Z,{style:{position:"absolute",bottom:"4%",right:"2%",width:"123px",borderRadius:12},"aria-label":"Basic example",children:[(0,o.jsx)(l.Z,{style:{backgroundColor:"street"===S?"#2fc1c1":"#202333"},variant:"secondary",onClick:function(){return N(qt.street)},children:(0,o.jsx)(c.Z,{src:"street_ic.png",style:{height:30,width:30}})}),(0,o.jsx)(l.Z,{style:{backgroundColor:"satellite"===S?"#2fc1c1":"#202333"},variant:"secondary",onClick:function(){return N(qt.satellite)},children:(0,o.jsx)(c.Z,{src:"satellite_ic.png",style:{height:30,width:30}})})]})]})},Xt=r(47806),Kt=r(88792),Jt=r(93621);function er(e){var t=e.eventKey,r=e.callback,n=e.children,a=u.useContext(Kt.Z),i=(0,Jt.k)(t,(function(){return r&&r(t)})),s=a===t;return(0,o.jsxs)(Xt.Z.Item,{className:"fw-bold border-dark text-light bg-transparent",as:C.Z.Header,onClick:i,style:{fontSize:"1.25em",cursor:"pointer"},eventKey:t,children:[s?"-":"+"," ",n]})}var tr=function(){var e=(0,a.Z)(u.useState(!1),2),t=e[0],r=e[1],n=function(){return r(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(l.Z,{variant:"outline-primary",className:"text-light fw-bold border-dark",style:{height:"100px",width:"100px"},onClick:function(){return r(!0)},children:[(0,o.jsx)(c.Z,{src:"help.svg"})," Help"]}),(0,o.jsxs)(M.Z,{show:t,size:"lg",onHide:n,contentClassName:"bg-dark",children:[(0,o.jsxs)(M.Z.Header,{style:{background:"#111320",fontFamily:"Abel",fontSize:"1.5em"},className:"text-primary border-dark",children:[(0,o.jsx)(M.Z.Title,{as:"h2",children:"FAQ"}),(0,o.jsx)(l.Z,{variant:"link",size:"sm",onClick:n,children:(0,o.jsx)(c.Z,{src:"close.svg"})})]}),(0,o.jsx)(M.Z.Body,{className:"bg-dark text-light",children:(0,o.jsxs)(Xt.Z,{defaultActiveKey:"0",children:[(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"0",children:"What is the Geo Web?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"0",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsx)("p",{children:"The Geo Web is a set of protocols and system of property rights for anchoring digital content to physical land."}),(0,o.jsxs)("p",{children:["Users interact with Geo Web content through a"," ",(0,o.jsx)("a",{href:"https://geoweb.app/",target:"_blank",rel:"noreferrer",children:"spatial browser"})," ","that uses GPS to retrieve content anchored to their current location. Content discovery is frictionless and orderly. We think the Geo Web can become especially useful as always-on smart devices like smartwatches and smartglasses are widely adopted."]})]})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"1",children:"What is the Geo Web Cadastre?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"1",children:(0,o.jsx)(C.Z.Body,{children:(0,o.jsxs)("p",{children:["A ",(0,o.jsx)("i",{children:"cadastre"})," is a register of property showing the extent, value, and ownership of land. This Cadastre interface is your home for viewing, claiming, transferring, and managing digital land parcels on the Geo Web."]})})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"2",children:"How do I buy Geo Web land? What is partial common ownership?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"2",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsxs)("p",{children:["The Geo Web\u2019s land market is administered under a system called"," ",(0,o.jsx)("a",{href:"https://docs.geoweb.network/concepts/partial-common-ownership",target:"_blank",rel:"noreferrer",children:"partial common ownership"}),". It\u2019s a blend between private and communal ownership. Geo Web land parcels are licensed rather than sold outright to market participants."]}),(0,o.jsx)("p",{children:"Licensors pay an annual network fee (10% on this testnet) based on their own public, self-assessed value of the parcel. To help make sure parcels aren\u2019t underpriced and \u201csquatted\u201d on, any other market participant can force transfer of a land parcel by paying the current licensor their self-assessed value."}),(0,o.jsxs)("p",{children:["It might seem a little"," ",(0,o.jsx)("a",{href:"https://www.radicalxchange.org/concepts/",target:"_blank",rel:"noreferrer",children:"radical"}),", but we believe that this system creates the right incentives, opportunities, and efficiency to globally scale the Geo Web network without a centralized authority."]})]})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"3",children:"What are network fees used for?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"3",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsx)("p",{children:"This is just a testnet, so the currency currently used to transact isn`'`t worth anything."}),(0,o.jsx)("p",{children:"When the Geo Web moves to a production network, network fees will be transparently allocated to incentivize permissionless, positive-sum value creation on the network. Network funds provide the opportunity to reward everything from core protocol development to content creation to onboarding new landowners to simply being an active user. This is intended to be managed in a credibly neutral way and with progressively decentralized governance."})]})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"4",children:"What are the requirements for interacting with the Cadastre?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"4",children:(0,o.jsx)(C.Z.Body,{children:(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"A modern web browser"}),(0,o.jsxs)("li",{children:["A Ethereum/web3 wallet (",(0,o.jsx)("a",{href:"https://metamask.io/download.html",target:"_blank",rel:"noreferrer",children:"MetaMask"}),","," ",(0,o.jsx)("a",{href:"https://walletconnect.org/",target:"_blank",rel:"noreferrer",children:"WalletConnect"}),","," ",(0,o.jsx)("a",{href:"https://toruswallet.io/",target:"_blank",rel:"noreferrer",children:"Torus"}),")"]}),(0,o.jsxs)("li",{children:[T.RU," (",(0,o.jsx)("a",{href:T.$d,target:"_blank",rel:"noreferrer",children:"Claim for free"})," ","or"," ",(0,o.jsx)("a",{href:"https://discord.com/invite/reXgPru7ck",target:"_blank",rel:"noreferrer",children:"join our Discord and ask our team to send you some"}),")"]})]})})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"5",children:"How do I use the Cadastre?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"5",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsx)("p",{children:"Use the Cadastre UI like other modern map interfaces. Zoom and pan across the globe to find points of interest and Geo Web land parcels. When you interact with a land parcel, all of its details will be shown in a panel on the left side of the screen."}),(0,o.jsx)("p",{children:"Click on a shaded polygon on the map to inspect the parcel details. You can edit the parcel and make network payments if you\u2019re the current licensor. You force a transfer if someone else currently licenses the land. You\u2019ll have to pay them their \u201cFor Sale Price\u201d plus any additional network fee prepayments and Ethereum transaction fees."}),(0,o.jsx)("p",{children:"Single click on an unshaded area of the map to start a new land parcel claim. You set the size and shape of your parcel claim (just rectangles for now)."}),(0,o.jsx)("p",{children:"Be a patient with your clicks, transactions, and movements :). We\u2019re in active development, and this is blockchain-based: speed isn\u2019t the top priority, yet."})]})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"6",children:"What can I do with my land parcel?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"6",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsx)("p",{children:"Land holders can name their land, add a URI link, and anchor 3D/AR content in a media gallery by navigating to and interacting with one of their parcels."}),(0,o.jsxs)("p",{children:["The Geo Web leverages"," ",(0,o.jsx)("a",{href:"https://ceramic.network/",target:"_blank",rel:"noreferrer",children:"Ceramic"})," ","and"," ",(0,o.jsx)("a",{href:"https://ipfs.io/",target:"_blank",rel:"noreferrer",children:"IPFS"})," ","for its content layer. The Cadastre automatically generates and links a root Ceramic stream for each claimed parcel to manage this linked content."]}),(0,o.jsxs)("p",{children:["We\u2019ve set up free automatic content pinning (",(0,o.jsx)("a",{href:"https://docs.textile.io/buckets/",target:"_blank",rel:"noreferrer",children:"Textile Buckets"}),") and archive functionality (",(0,o.jsx)("a",{href:"https://filecoin.io/",target:"_blank",rel:"noreferrer",children:"Filecoin"}),") to make this initial experience really simple. There are limits on these services and in the long-run will open up the experience for customization and open integration."]})]})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"7",children:"What are the use cases?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"7",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsx)("p",{children:"The Geo Web\u2019s protocols are designed to be agnostic and foundational. They\u2019re intended to be narrow-waist protocols to enable innovation above (use cases) and below (hardware, OS, etc.) without changes to the protocols themselves."}),(0,o.jsx)("p",{children:"NFTs, Digital art, games, micro-applications, audio files, and other media can be anchored to specific geolocations to augment the physical environment. This augmentation layer is deterministic and shared for all Geo Web users. Let your imagination run wild with what you could do with digital objects/information persisted in the real world."}),(0,o.jsx)("p",{children:"A simple, post-COVID application might be a restaurant anchoring their digital menu to their location rather than using a QR Code to deliver it."})]})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"8",children:"What stage of development is the Geo Web in?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"8",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsxs)("p",{children:["Beta/testnet. We are actively working on the initial, mainnet-ready Geo Web smart contracts, supporting infrastructure, Cadastre, and browser. The actions and use cases that you build on this testnet will help make the product better and inform our roadmap. So, let it rip! Hit us up"," ",(0,o.jsx)("a",{href:"https://discord.com/invite/reXgPru7ck",target:"_blank",rel:"noreferrer",children:"in our Discord"})," ","if you have feedback."]}),(0,o.jsxs)("p",{children:["Note: Even though the Geo Web is on testnet, it"," ",(0,o.jsx)("i",{children:"can work"})," for real world use cases. The economic incentives just aren\u2019t the same."]})]})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"9",children:"Does the Geo Web have its own token?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"9",children:(0,o.jsx)(C.Z.Body,{children:(0,o.jsx)("p",{children:"No."})})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"10",children:"Who owns/controls/makes money from the Geo Web?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"10",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsx)("p",{children:"The Geo Web is a public good, so we all own it."}),(0,o.jsx)("p",{children:"The core team will initially have the ability to modify the core infrastructure out of necessity. As the technology and the network matures, we will progressively decentralize this decision making authority. Our goal is to \u201cExit to Community\u201d at which time, all Geo Web governance will be handled through democratic (for financial decisions) and decentralized (for technical) processes."}),(0,o.jsx)("p",{children:"The network itself will generate funds through its partial common ownership system, but no one person, team, or entity will have control of that cash flow. We hope lots of people make money (by creating value) on the Geo Web."})]})})]}),(0,o.jsxs)(C.Z,{className:"bg-transparent border-dark text-light",children:[(0,o.jsx)(er,{eventKey:"11",children:"How can I learn more? How can I get involved?"}),(0,o.jsx)(Xt.Z.Collapse,{eventKey:"11",children:(0,o.jsxs)(C.Z.Body,{children:[(0,o.jsx)("p",{children:"We\u2019re an open org/project. We\u2019re always looking for contributors, feedback, and questions."}),(0,o.jsxs)("p",{children:["Jump in our"," ",(0,o.jsx)("a",{href:"https://discord.com/invite/reXgPru7ck",target:"_blank",rel:"noreferrer",children:"Discord"}),", explore our"," ",(0,o.jsx)("a",{href:"https://github.com/Geo-Web-Project",target:"_blank",rel:"noreferrer",children:"Github repos"}),", or engage with us on"," ",(0,o.jsx)("a",{href:"https://twitter.com/thegeoweb",target:"_blank",rel:"noreferrer",children:"Twitter"}),". Discord and Github engagement can even earn you"," ",(0,o.jsx)("a",{href:"https://geo-web-project.github.io/sourcecred-instance/#/explorer",target:"_blank",rel:"noreferrer",children:"SourceCred-based payouts"}),"!"]}),(0,o.jsxs)("p",{children:["Hit us up at"," ",(0,o.jsx)("a",{href:"mailto:info@geoweb.network",children:"info@geoweb.network"}),", jump in on"," ",(0,o.jsx)("a",{href:"https://github.com/Geo-Web-Project",target:"_blank",rel:"noreferrer"}),"our Github organization, or even"," ",(0,o.jsx)("a",{href:"http://bit.ly/geowebcalendly",target:"_blank",rel:"noreferrer",children:"schedule a call with us"}),"."]})]})})]})]})})]})]})},rr=r(27977);var nr=function(e){var t,r=e.account,n=e.ceramic,i=e.registryContract,s=e.setSelectedParcelId,d=e.setInteractionState,p=e.disconnectWallet,m=e.paymentToken,f=e.provider,h=e.portfolioNeedActionCount,x=e.setPortfolioNeedActionCount,g=e.setPortfolioParcelCoords,b=e.isPortfolioToUpdate,v=e.setIsPortfolioToUpdate,y=(0,a.Z)(u.useState(!1),2),j=y[0],w=y[1],k=function(){return w(!0)},S=O.hm.useAccountTokenSnapshotsQuery({chainId:T.er,filter:{account:r,token:null!==(t=null===m||void 0===m?void 0:m.address)&&void 0!==t?t:""}},{pollingInterval:5e3,skip:null==m}),Z=S.isLoading,C=S.data;return(0,o.jsxs)("div",{className:"d-flex flex-column ms-auto align-items-center fit-content",children:[(0,o.jsxs)(Dt.Z,{className:"bg-dark border-secondary",children:[(0,o.jsx)(l.Z,{variant:"secondary",disabled:j,onClick:k,className:"text-light",children:Z||null==C?(0,o.jsx)(Y.Z,{animation:"border",role:"status"}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(U,{format:function(e){return W(P.bM(e),3)+" ETHx"},accountTokenSnapshot:C.items[0]}),(0,o.jsx)(Ne,{accountTokenSnapshot:C.items[0],account:r,ceramic:n,registryContract:i,provider:f,paymentToken:m,showProfile:j,handleCloseProfile:function(){return w(!1)},disconnectWallet:p,setPortfolioNeedActionCount:x,setSelectedParcelId:s,setInteractionState:d,setPortfolioParcelCoords:g,isPortfolioToUpdate:b,setIsPortfolioToUpdate:v})]})}),(0,o.jsxs)(l.Z,{variant:"outline-secondary",disabled:j,onClick:k,className:"text-light bg-dark",children:[G(r,14)," ",h?(0,o.jsx)(A.Z,{trigger:["hover","focus"],placement:"bottom",delay:{show:250,hide:400},overlay:(0,o.jsx)(R.Z,{children:"You have parcels that require attention."}),children:(0,o.jsx)(rr.Z,{bg:"danger",pill:!0,text:"light",children:h})}):(0,o.jsx)(c.Z,{src:"./ProfileIcon.png"})]})]}),(0,o.jsx)("a",{className:"faucet-link text-white mt-1",target:"_blank",href:T.$d,children:"Request testnet ETH"})]})},ar=r(43720),ir=r(45599),sr=r(12152),or=r(95611),cr=r(87630),lr=r(241),ur=r(96263),dr=r(97161),pr=r(34111),mr=r(28743),fr=r(95040),hr=r(16880),xr=mr.providers.httpClient,gr=mr.providers.jsIpfs;var br=function(){var e=(0,a.Z)((0,z.Wx)(),3),t=e[0],i=e[1],d=e[2],m=(0,a.Z)(u.useState(null),2),f=m[0],h=m[1],x=(0,a.Z)(u.useState(null),2),g=x[0],b=x[1],y=(0,a.Z)(u.useState(null),2),j=y[0],w=y[1],k=(0,a.Z)(u.useState(null),2),S=k[0],Z=k[1],C=Je().firebasePerf,N=(0,a.Z)(u.useState(void 0),2),P=N[0],I=N[1],F=(0,a.Z)(u.useState(void 0),2),L=F[0],A=F[1],R=(0,a.Z)(u.useState(0),2),D=R[0],G=R[1],W=(0,a.Z)(u.useState(""),2),M=W[0],B=W[1],_=(0,a.Z)(u.useState(Wt.VIEWING),2),O=_[0],U=_[1],Y=(0,a.Z)(u.useState(null),2),q=Y[0],H=Y[1],$=(0,a.Z)(u.useState(!1),2),V=$[0],Q=$[1],X=function(){var e=(0,n.Z)(s().mark((function e(){var t,r,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:return t=e.sent,c=null===t||void 0===t?void 0:t.provider.state.provider,r=new lr.Q(c,"any"),Z(r),e.next=7,dr.gQ.create({chainId:T.er,provider:new ur.J(T.er,"563dbce996e34aeab8088bbd154d4620")});case 7:return a=e.sent,A(a),e.next=11,a.loadNativeAssetSuperToken("ETHx");case 11:o=e.sent,I(o),(0,pr.vZ)(T.er,(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r);case 1:case"end":return e.stop()}}),e)}))));case 14:case"end":return e.stop()}var c}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();u.useEffect((function(){if("connected"===t.status){var e=function(){var e=(0,n.Z)(s().mark((function e(){var n,a,i,o,c,l,u,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("cacao"),localStorage.removeItem("sessionSeed"),e.next=4,(0,sr.If)(t.connected.provider.state.provider);case 4:return n=new cr.KS(t.connected.provider.state.provider,t.connected.accountID.address),a=new hr.G({authProvider:n}),e.next=8,a.authorize();case 8:if(i=e.sent,(o=new or.v(T.bL)).did=i,b(o),j){e.next=22;break}return e.next=15,(0,mr.getIpfs)({providers:[xr({loadHttpClientModule:function(){return r(85241)},apiAddress:"/ip4/127.0.0.1/tcp/5001"}),gr({loadJsIpfsModule:function(){return fr},options:{preload:{enabled:!1}}})]});case 15:c=e.sent,l=c.ipfs,u=c.provider,d=c.apiAddress,console.log("IPFS API is provided by: "+u),"httpClient"===u&&console.log("HTTP API address: "+d),w(l);case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[t]),u.useEffect((function(){function e(){return(e=(0,n.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=L){e.next=2;break}return e.abrupt("return");case 2:t=(0,ir.getContractsForChainOrThrow)(T.er,L.settings.provider).registryDiamondContract,h(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[L]);var J=function(){return"connected"!==t.status?(0,o.jsxs)(l.Z,{variant:"outline-primary",className:"text-light fw-bold border-dark",style:{height:"100px"},disabled:"connecting"===t.status,onClick:function(){X()},children:[(0,o.jsx)(c.Z,{src:"vector.png",width:"40",style:{marginRight:20}}),"Connect Wallet"]}):(0,o.jsx)(o.Fragment,{children:g&&f&&P&&S&&(0,o.jsx)(nr,{account:t.connected.accountID.address,ceramic:g,registryContract:f,disconnectWallet:K,paymentToken:P,provider:S,portfolioNeedActionCount:D,setPortfolioNeedActionCount:G,setSelectedParcelId:B,interactionState:O,setInteractionState:U,setPortfolioParcelCoords:H,isPortfolioToUpdate:V,setIsPortfolioToUpdate:Q})})};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(fe.Z,{fluid:!0,children:(0,o.jsxs)(ar.Z,{bg:"dark",variant:"dark",fixed:"top",style:{height:"100px"},className:"border-bottom border-purple border-opacity-25",children:[(0,o.jsx)(v.Z,{sm:"3",className:"ps-3 pe-3",children:(0,o.jsx)(tr,{})}),(0,o.jsxs)(v.Z,{sm:"6",className:"text-center p-2 mx-auto",children:[(0,o.jsxs)("div",{className:"text-primary",style:{fontSize:"2.5em",fontFamily:"Abel"},children:[(0,o.jsx)(c.Z,{style:{height:"1.1em"},src:"logo.png"})," Geo Web Cadastre"]}),(0,o.jsx)("div",{className:"text-light",style:{fontSize:"1em"},children:"Claim, transfer, and manage digital land"})]}),(0,o.jsx)(v.Z,{sm:"3",className:"ps-3 pe-3 text-end",children:(0,o.jsx)(J,{})})]})}),(0,o.jsx)(fe.Z,{fluid:!0,children:"connected"===t.status&&f&&S&&P&&g&&j&&C&&L?(0,o.jsx)(E.Z,{children:(0,o.jsx)(Qt,{registryContract:f,account:t.connected.accountID.address,provider:S,ceramic:g,ipfs:j,firebasePerf:C,paymentToken:P,sfFramework:L,disconnectWallet:K,setPortfolioNeedActionCount:G,selectedParcelId:M,setSelectedParcelId:B,interactionState:O,setInteractionState:U,portfolioParcelCoords:q,isPortfolioToUpdate:V,setPortfolioParcelCoords:H,setIsPortfolioToUpdate:Q})}):(0,o.jsx)(p,{connectWallet:X,status:t.status})})]})}},7420:function(){},95856:function(){},35883:function(){},46601:function(){},89214:function(){},41415:function(){},52596:function(){},77391:function(){},47005:function(){},26937:function(){},26784:function(){},6525:function(){},48851:function(){},36471:function(){},49835:function(){},21724:function(){},62678:function(){},25819:function(){},24112:function(){}},function(e){e.O(0,[655,956,653,774,888,179],(function(){return t=48312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);